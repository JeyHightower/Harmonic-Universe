import{j as e,L as l,u as E,a as b,b as v,c as R,r as a,R as D,O as S}from"./index-bAPWLjom.js";function T(){return e.jsxs("header",{style:{borderBottom:"1px solid #eaeaea",padding:"1rem 2rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("div",{className:"logo",children:e.jsx(l,{to:"/",style:{textDecoration:"none",color:"#1890ff",fontWeight:"bold",fontSize:"1.5rem"},children:"Harmonic Universe"})}),e.jsx("nav",{children:e.jsxs("ul",{style:{display:"flex",gap:"1.5rem",listStyle:"none",margin:0,padding:0},children:[e.jsx("li",{children:e.jsx(l,{to:"/",style:{textDecoration:"none",color:"#333"},children:"Home"})}),e.jsx("li",{children:e.jsx(l,{to:"/dashboard",style:{textDecoration:"none",color:"#333"},children:"Dashboard"})}),e.jsx("li",{children:e.jsx(l,{to:"/profile",style:{textDecoration:"none",color:"#333"},children:"Profile"})}),e.jsx("li",{children:e.jsx(l,{to:"/login",style:{textDecoration:"none",color:"#333"},children:"Login"})})]})})]})}function C(){return e.jsx("footer",{style:{textAlign:"center",padding:"1rem",borderTop:"1px solid #eaeaea",marginTop:"2rem"},children:e.jsxs("p",{children:["Â© ",new Date().getFullYear()," Harmonic Universe. All rights reserved."]})})}let c;try{c=require("../constants/modalTypes").MODAL_TYPES}catch{console.warn("MODAL_TYPES not available, using fallback"),c={LOGIN:"LOGIN",REGISTER:"REGISTER"}}let d;try{d=require("../features/auth/authSlice").demoLogin}catch{console.warn("demoLogin not available, using fallback"),d=()=>(console.error("Demo login not implemented"),{type:"auth/demoLogin/rejected",error:"Not implemented"})}class w extends D.Component{constructor(t){super(t),this.state={hasError:!1,errorInfo:null}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(t,n){console.error("Content error caught:",t),console.error("Component stack:",n.componentStack),this.setState({errorInfo:n})}render(){return this.state.hasError?e.jsxs("div",{style:{padding:"20px",textAlign:"center",color:"#ff4d4f"},children:[e.jsx("h3",{children:"Content Error"}),e.jsx("p",{children:"There was a problem loading this content."}),e.jsx("button",{onClick:()=>this.setState({hasError:!1,errorInfo:null}),style:{padding:"5px 10px",marginTop:"10px"},children:"Try Again"}),e.jsx("button",{onClick:()=>window.location.reload(),style:{padding:"5px 10px",marginTop:"10px",marginLeft:"10px"},children:"Reload Page"})]}):this.props.children}}function P(){const[o,t]=a.useState(null);a.useEffect(()=>{t(null)},[]);try{return e.jsx(S,{})}catch(n){return o||t(n),console.error("Error rendering Outlet:",n),e.jsxs("div",{style:{padding:"20px",textAlign:"center",color:"#ff4d4f"},children:[e.jsx("h3",{children:"Rendering Error"}),e.jsxs("p",{children:["Failed to render content: ",(o==null?void 0:o.message)||"Unknown error"]}),e.jsx("button",{onClick:()=>window.location.reload(),style:{padding:"5px 10px",marginTop:"10px"},children:"Reload Page"})]})}}function I(){let o,t;try{o=E(),t=b()}catch(r){console.error("Error accessing router hooks:",r)}let n;try{n=v()}catch(r){console.error("Redux dispatch not available:",r)}const u=R(),s=u==null?void 0:u.openModal,[y,j]=a.useState(!1),[g,h]=a.useState(null),x=a.useCallback(async()=>{if(!n||typeof d!="function"){console.error("Redux dispatch or demoLogin not available");return}console.log("Executing demo login...");try{console.log("Dispatching demo login action");const r=await n(d());r.meta&&r.meta.requestStatus==="fulfilled"?(console.log("Demo login successful, navigating to dashboard"),t&&t("/dashboard",{replace:!0})):console.error("Demo login failed:",r.error)}catch(r){console.error("Error during demo login:",r)}},[n,t]),f=a.useCallback(()=>{if(!(!o||!o.search))try{console.log("[Layout] Processing URL parameters");const r=new URLSearchParams(o.search),i=r.get("modal");i&&s&&(console.log("Layout detected modal parameter:",i),i==="login"?(console.log("Opening login modal from URL parameter"),s(c.LOGIN)):i==="register"&&(console.log("Opening register modal from URL parameter"),s(c.REGISTER))),r.get("demo")==="true"&&(console.log("Demo login requested via URL parameter"),x());const m=r.get("redirect");m&&t&&(console.log(`[Layout] Navigating to: ${m}`),setTimeout(()=>{try{t(m,{replace:!0})}catch(L){console.error("[Layout] Navigation error:",L)}},0))}catch(r){console.error("[Layout] Error processing URL parameters:",r),h(r)}},[o,t,s,x]);return a.useEffect(()=>{let r=!0;return(async()=>{try{console.log("[Layout] Component mounting..."),o&&setTimeout(()=>{r&&f()},50),r&&j(!0)}catch(p){console.error("[Layout] Initialization error:",p),r&&h(p)}})(),()=>{r=!1,console.log("[Layout] Component unmounted")}},[o,f]),!y&&!g?e.jsx("div",{style:{padding:"20px",textAlign:"center"},children:e.jsx("p",{children:"Initializing layout..."})}):g?e.jsxs("div",{style:{padding:"20px",textAlign:"center",color:"#ff4d4f"},children:[e.jsx("h3",{children:"Layout Error"}),e.jsxs("p",{children:["Failed to initialize layout: ",g.message]}),e.jsx("button",{onClick:()=>window.location.reload(),style:{padding:"5px 10px",marginTop:"10px"},children:"Reload Page"})]}):e.jsxs("div",{className:"app-layout",children:[e.jsx(T,{}),e.jsx("main",{className:"app-content",children:e.jsx(w,{children:e.jsx(P,{})})}),e.jsx(C,{})]})}export{I as default};
