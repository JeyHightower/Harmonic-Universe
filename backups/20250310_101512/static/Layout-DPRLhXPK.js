import{s as f,a as x,b as y,u as L,j as e}from"./index-CiITkpH1.js";import{a as s,O as E}from"./vendor-react-DJ7Kff-Q.js";let c;try{c=require("../constants/modalTypes").MODAL_TYPES}catch{console.warn("MODAL_TYPES not available, using fallback"),c={LOGIN:"LOGIN",REGISTER:"REGISTER"}}let d;try{d=require("../features/auth/authSlice").demoLogin}catch{console.warn("demoLogin not available, using fallback"),d=()=>(console.error("Demo login not implemented"),{type:"auth/demoLogin/rejected",error:"Not implemented"})}let g;try{g=require("./Navbar").default}catch{console.warn("[Layout] Navbar component not available, using fallback"),g=()=>e.jsx("header",{className:"navbar-fallback",style:{padding:"10px 20px",backgroundColor:"#f0f0f0",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:e.jsx("h1",{style:{margin:0,fontSize:"1.5rem"},children:"Harmonic Universe"})})}let p;try{p=require("./layout/Footer").default}catch{console.warn("[Layout] Footer component not available, using fallback"),p=()=>e.jsx("footer",{className:"footer-fallback",style:{padding:"10px 20px",backgroundColor:"#f0f0f0",textAlign:"center",marginTop:"auto"},children:e.jsxs("p",{style:{margin:0},children:["Harmonic Universe Â© ",new Date().getFullYear()]})})}class j extends s.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(t,n){console.error("[Layout] Error caught in ContentErrorBoundary:",t),console.error("[Layout] Error info:",n),this.setState({error:t})}render(){var t;return this.state.hasError?e.jsxs("div",{className:"error-container",style:{padding:"20px",textAlign:"center",backgroundColor:"#ffdddd",borderRadius:"5px",margin:"20px 0"},children:[e.jsx("h2",{children:"Something went wrong"}),e.jsx("p",{children:"An error occurred while rendering the content."}),e.jsxs("p",{children:["Error: ",((t=this.state.error)==null?void 0:t.message)||"Unknown error"]}),e.jsx("button",{onClick:()=>window.location.reload(),style:{padding:"10px 15px",backgroundColor:"#f44336",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",marginTop:"10px"},children:"Reload Page"})]}):this.props.children}}function b(){try{return e.jsx(E,{})}catch(o){return console.error("[Layout] Error rendering Outlet:",o),e.jsxs("div",{className:"outlet-error",children:[e.jsx("h2",{children:"Navigation Error"}),e.jsx("p",{children:"An error occurred when trying to render the route content."}),e.jsxs("p",{children:["Error: ",o.message]})]})}}function D(){const o=f(),t=x(),n=y();let a;try{a=L()}catch(r){console.error("[Layout] Error accessing modal context:",r),a=null}const l=a==null?void 0:a.openModal,[m,v]=s.useState(!1),[u,w]=s.useState(null);s.useEffect(()=>(console.log("[Layout] Component mounted successfully"),console.log("[Layout] Context check:",{location:!!o,navigate:!!t,dispatch:!!n,modalContext:!!a}),()=>{console.log("[Layout] Component unmounted")}),[]),s.useEffect(()=>{if(!l||!n){console.log("[Layout] Missing openModal or dispatch, skipping URL parameter handling");return}try{const r=new URLSearchParams(o.search),i=r.get("modal");i&&(console.log("[Layout] Detected modal parameter:",i),i==="login"?(console.log("[Layout] Opening login modal from URL parameter"),l(c.LOGIN)):i==="register"&&(console.log("[Layout] Opening register modal from URL parameter"),l(c.REGISTER))),r.get("demo")==="true"&&(console.log("[Layout] Demo login requested via URL parameter"),h())}catch(r){console.error("[Layout] Error handling URL parameters:",r)}},[o.search,l,n]);const h=async()=>{if(!n||typeof d!="function"){console.error("[Layout] Redux dispatch or demoLogin not available");return}console.log("[Layout] Executing demo login...");try{console.log("[Layout] Dispatching demo login action");const r=await n(d());r.meta&&r.meta.requestStatus==="fulfilled"?(console.log("[Layout] Demo login successful, navigating to dashboard"),t("/dashboard",{replace:!0})):console.error("[Layout] Demo login failed:",r.error)}catch(r){console.error("[Layout] Error during demo login:",r)}};return!m&&!u?e.jsx("div",{style:{padding:"20px",textAlign:"center"},children:e.jsx("p",{children:"Initializing layout..."})}):u?e.jsxs("div",{style:{padding:"20px",textAlign:"center",color:"#ff4d4f"},children:[e.jsx("h3",{children:"Layout Error"}),e.jsxs("p",{children:["Failed to initialize layout: ",u.message]}),e.jsx("button",{onClick:()=>window.location.reload(),style:{padding:"5px 10px",marginTop:"10px"},children:"Reload Page"})]}):e.jsxs("div",{className:"app-layout",children:[e.jsx(g,{}),e.jsx("main",{className:"app-content",children:e.jsx(j,{children:e.jsx(b,{})})}),e.jsx(p,{})]})}export{D as default};
