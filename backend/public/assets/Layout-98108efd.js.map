{"version":3,"mappings":"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","names":["MODAL_TYPES","__vitePreload","module","error","demoLogin","n","NavbarFallback","jsxDEV","this","Navbar","lazy","FooterFallback","Footer","ContentErrorBoundary","React","props","info","_a","SafeOutlet","Outlet","Layout","location","safeUseLocation","navigate","safeUseNavigate","dispatch","safeUseDispatch","modalContext","useModal","openModal","initialized","setInitialized","useState","setError","useEffect","searchParams","modalParam","handleDemoLogin","resultAction","Suspense"],"sources":["../../src/components/Layout.jsx"],"sourcesContent":["import React, { useEffect, useState, useCallback, lazy, Suspense } from 'react';\nimport { Outlet } from 'react-router-dom';\nimport { useModal } from '../contexts/ModalContext';\n\n// Import safe versions of hooks\nimport { safeUseLocation, safeUseNavigate } from '../utils/ensure-router-provider';\nimport { safeUseDispatch } from '../utils/ensure-redux-provider';\nimport { safeImport } from '../utils/dynamic-import';\n\n// Import with fallbacks using dynamic imports\nlet MODAL_TYPES;\ntry {\n    // Use dynamic import instead of require\n    import('../constants/modalTypes').then(module => {\n        MODAL_TYPES = module.MODAL_TYPES;\n    }).catch(error => {\n        console.warn('MODAL_TYPES not available, using fallback');\n        MODAL_TYPES = {\n            LOGIN: 'LOGIN',\n            REGISTER: 'REGISTER'\n        };\n    });\n\n    // Initialize with fallback in case the import hasn't resolved yet\n    MODAL_TYPES = {\n        LOGIN: 'LOGIN',\n        REGISTER: 'REGISTER'\n    };\n} catch (error) {\n    console.warn('MODAL_TYPES not available, using fallback');\n    MODAL_TYPES = {\n        LOGIN: 'LOGIN',\n        REGISTER: 'REGISTER'\n    };\n}\n\n// Import demoLogin with fallback\nlet demoLogin;\ntry {\n    // Use dynamic import instead of require\n    import('../features/auth/authSlice').then(module => {\n        demoLogin = module.demoLogin;\n    }).catch(error => {\n        console.warn('demoLogin not available, using fallback');\n        demoLogin = () => {\n            console.error('Demo login not implemented');\n            return { type: 'auth/demoLogin/rejected', error: 'Not implemented' };\n        };\n    });\n\n    // Initialize with fallback in case the import hasn't resolved yet\n    demoLogin = () => {\n        console.error('Demo login not implemented');\n        return { type: 'auth/demoLogin/rejected', error: 'Not implemented' };\n    };\n} catch (error) {\n    console.warn('demoLogin not available, using fallback');\n    demoLogin = () => {\n        console.error('Demo login not implemented');\n        return { type: 'auth/demoLogin/rejected', error: 'Not implemented' };\n    };\n}\n\n// Navbar with React.lazy for code splitting\nconst NavbarFallback = () => (\n    <header className=\"navbar-fallback\" style={{\n        padding: '10px 20px',\n        backgroundColor: '#f0f0f0',\n        boxShadow: '0 2px 4px rgba(0,0,0,0.1)'\n    }}>\n        <h1 style={{ margin: 0, fontSize: '1.5rem' }}>Harmonic Universe</h1>\n    </header>\n);\n\n// Use React.lazy instead of require\nconst Navbar = lazy(() =>\n    import('./Navbar')\n        .catch(error => {\n            console.warn('[Layout] Navbar component not available, using fallback');\n            return { default: NavbarFallback };\n        })\n);\n\n// Footer with React.lazy for code splitting\nconst FooterFallback = () => (\n    <footer className=\"footer-fallback\" style={{\n        padding: '10px 20px',\n        backgroundColor: '#f0f0f0',\n        textAlign: 'center',\n        marginTop: 'auto'\n    }}>\n        <p style={{ margin: 0 }}>Harmonic Universe &copy; {new Date().getFullYear()}</p>\n    </footer>\n);\n\n// Use React.lazy instead of require\nconst Footer = lazy(() =>\n    import('./layout/Footer')\n        .catch(error => {\n            console.warn('[Layout] Footer component not available, using fallback');\n            return { default: FooterFallback };\n        })\n);\n\n// Content error boundary to catch and handle errors in child components\nclass ContentErrorBoundary extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = { hasError: false, error: null };\n    }\n\n    static getDerivedStateFromError() {\n        return { hasError: true };\n    }\n\n    componentDidCatch(error, info) {\n        console.error('[Layout] Error caught in ContentErrorBoundary:', error);\n        console.error('[Layout] Error info:', info);\n        this.setState({ error });\n    }\n\n    render() {\n        if (this.state.hasError) {\n            return (\n                <div className=\"error-container\" style={{\n                    padding: '20px',\n                    textAlign: 'center',\n                    backgroundColor: '#ffdddd',\n                    borderRadius: '5px',\n                    margin: '20px 0'\n                }}>\n                    <h2>Something went wrong</h2>\n                    <p>An error occurred while rendering the content.</p>\n                    <p>Error: {this.state.error?.message || 'Unknown error'}</p>\n                    <button\n                        onClick={() => window.location.reload()}\n                        style={{\n                            padding: '10px 15px',\n                            backgroundColor: '#f44336',\n                            color: 'white',\n                            border: 'none',\n                            borderRadius: '4px',\n                            cursor: 'pointer',\n                            marginTop: '10px'\n                        }}\n                    >\n                        Reload Page\n                    </button>\n                </div>\n            );\n        }\n\n        return this.props.children;\n    }\n}\n\n// Safe wrapper for React Router Outlet\nfunction SafeOutlet() {\n    try {\n        return <Outlet />;\n    } catch (error) {\n        console.error('[Layout] Error rendering Outlet:', error);\n        return (\n            <div className=\"outlet-error\">\n                <h2>Navigation Error</h2>\n                <p>An error occurred when trying to render the route content.</p>\n                <p>Error: {error.message}</p>\n            </div>\n        );\n    }\n}\n\n// Main Layout component with enhanced error handling\nfunction Layout() {\n    // Use safe versions of hooks\n    const location = safeUseLocation();\n    const navigate = safeUseNavigate();\n    const dispatch = safeUseDispatch();\n\n    // Improve context validation\n    let modalContext;\n    try {\n        modalContext = useModal();\n    } catch (error) {\n        console.error('[Layout] Error accessing modal context:', error);\n        modalContext = null;\n    }\n\n    const openModal = modalContext?.openModal;\n\n    // Local state for component needs\n    const [initialized, setInitialized] = useState(false);\n    const [error, setError] = useState(null);\n\n    // Log component mount\n    useEffect(() => {\n        console.log('[Layout] Component mounted successfully');\n\n        // Log available contexts and hooks\n        console.log('[Layout] Context check:', {\n            'location': !!location,\n            'navigate': !!navigate,\n            'dispatch': !!dispatch,\n            'modalContext': !!modalContext\n        });\n\n        return () => {\n            console.log('[Layout] Component unmounted');\n        };\n    }, []);\n\n    // Handle URL parameters for modals and demo login\n    useEffect(() => {\n        if (!openModal || !dispatch) {\n            console.log('[Layout] Missing openModal or dispatch, skipping URL parameter handling');\n            return; // Exit early if dependencies aren't available\n        }\n\n        try {\n            const searchParams = new URLSearchParams(location.search);\n\n            // Check for modal parameter\n            const modalParam = searchParams.get('modal');\n            if (modalParam) {\n                console.log('[Layout] Detected modal parameter:', modalParam);\n\n                if (modalParam === 'login') {\n                    console.log('[Layout] Opening login modal from URL parameter');\n                    openModal(MODAL_TYPES.LOGIN);\n                } else if (modalParam === 'register') {\n                    console.log('[Layout] Opening register modal from URL parameter');\n                    openModal(MODAL_TYPES.REGISTER);\n                }\n            }\n\n            // Check for demo parameter\n            const demoParam = searchParams.get('demo');\n            if (demoParam === 'true') {\n                console.log('[Layout] Demo login requested via URL parameter');\n                handleDemoLogin();\n            }\n        } catch (error) {\n            console.error('[Layout] Error handling URL parameters:', error);\n        }\n    }, [location.search, openModal, dispatch]);\n\n    // Handle demo login with error handling\n    const handleDemoLogin = async () => {\n        if (!dispatch || typeof demoLogin !== 'function') {\n            console.error('[Layout] Redux dispatch or demoLogin not available');\n            return;\n        }\n\n        console.log('[Layout] Executing demo login...');\n\n        try {\n            console.log('[Layout] Dispatching demo login action');\n            const resultAction = await dispatch(demoLogin());\n\n            if (resultAction.meta && resultAction.meta.requestStatus === 'fulfilled') {\n                console.log('[Layout] Demo login successful, navigating to dashboard');\n\n                // Clear URL parameters\n                navigate('/dashboard', { replace: true });\n            } else {\n                console.error('[Layout] Demo login failed:', resultAction.error);\n                // Optionally show error notification here\n            }\n        } catch (error) {\n            console.error('[Layout] Error during demo login:', error);\n        }\n    };\n\n    // Show a simplified loading state during initialization\n    if (!initialized && !error) {\n        return (\n            <div style={{ padding: '20px', textAlign: 'center' }}>\n                <p>Initializing layout...</p>\n            </div>\n        );\n    }\n\n    // Show error if initialization failed\n    if (error) {\n        return (\n            <div style={{ padding: '20px', textAlign: 'center', color: '#ff4d4f' }}>\n                <h3>Layout Error</h3>\n                <p>Failed to initialize layout: {error.message}</p>\n                <button\n                    onClick={() => window.location.reload()}\n                    style={{ padding: '5px 10px', marginTop: '10px' }}\n                >\n                    Reload Page\n                </button>\n            </div>\n        );\n    }\n\n    // Standard render with enhanced error protection\n    return (\n        <div className=\"app-layout\">\n            <Suspense fallback={<div>Loading Navbar...</div>}>\n                <Navbar />\n            </Suspense>\n            <main className=\"app-content\">\n                <ContentErrorBoundary>\n                    <SafeOutlet />\n                </ContentErrorBoundary>\n            </main>\n            <Suspense fallback={<div>Loading Footer...</div>}>\n                <Footer />\n            </Suspense>\n        </div>\n    );\n}\n\nexport default Layout;\n"],"file":"assets/Layout-98108efd.js"}