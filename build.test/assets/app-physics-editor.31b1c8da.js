import{r as e,j as t}from"./vendor-react-core.73efc664.js";import{u as i}from"./vendor-react-router.6468192e.js";import{T as s,f as n,g as o,A as r,S as a,c as l,D as d}from"./vendor-mui-core.4359195f.js";import{B as m,G as c}from"./vendor-mui-layout.b03fb29f.js";import{F as p,T as j}from"./vendor-mui-inputs.b77362ac.js";import{C as v,a as h}from"./vendor-mui-card.3348f8fd.js";import{B as x}from"./vendor-mui-buttons.74e6c144.js";import"./vendor-tone-classnames.ea5eadd4.js";import"./vendor-tone-dist.6485732f.js";import"./vendor-tone-module.5bbe5778.js";import"./vendor-tone-util.a79eb63f.js";import"./vendor-tone-helpers.07e4d08d.js";import"./vendor-tone-platform.4f06f964.js";import"./vendor-tone-browser.dd42b0e8.js";import"./vendor-tone-classes.909fbaba.js";import"./vendor-tone-core-base.398f9a2a.js";import"./vendor-tone-defaults.617853c7.js";import"./vendor-tone-cancel.b93f499f.js";import"./vendor-tone-adapters.ec1cb8a7.js";import"./vendor-tone-lodash.1d9c6a83.js";import"./vendor-tone-events.9afa7530.js";import"./vendor-tone-audio.70450c41.js";import"./vendor-tone-source.0b4b1ccd.js";import"./vendor-tone-tslib.f5f62bcb.js";import"./vendor-tone-signal.648ab60f.js";import"./vendor-tone-components.680c7d7e.js";import"./vendor-tone-esm.8edb30e2.js";import"./vendor-tone-type.9e20d569.js";import"./vendor-tone-styled-engine.72d9b7d5.js";import"./vendor-emotion-styled.ae0fdb08.js";import"./vendor-emotion-core.fcf170e6.js";import"./vendor-tone-src.89c6b4f5.js";import"./vendor-tone-StyledEngineProvider.626b917c.js";import"./vendor-tone-GlobalStyles.58bf1e29.js";import"./vendor-tone-createTheme.6c673f08.js";import"./vendor-tone-styleFunctionSx.dbcb4226.js";import"./vendor-tone-instruments.3eb491c0.js";import"./vendor-tone-effects.66f8dc4e.js";import"./vendor-react-dom.e7130502.js";import"./vendor-react-scheduler.c51d43b5.js";import"./vendor-tone-hooks.ee856eec.js";import"./vendor-tone-es.9387ac1c.js";import"./vendor-tone-dist-web.442e5e08.js";import"./vendor-tone-Selector.7ca3b0ed.js";import"./vendor-tone-TimePanel.ca272323.js";import"./vendor-tone-panels.35d19878.js";import"./vendor-tone-DatetimePanel.eb5b0baf.js";import"./vendor-tone-DatePanel.9f66ebd0.js";import"./vendor-tone-WeekPanel.896778be.js";import"./vendor-tone-MonthPanel.70b7688e.js";import"./vendor-tone-QuarterPanel.144363f0.js";import"./vendor-tone-YearPanel.b92617d1.js";import"./vendor-tone-DecadePanel.8c0dc02f.js";import"./vendor-tone-TabPanelList.10481429.js";import"./vendor-tone-TabNavList.2513addc.js";import"./vendor-tone-Dialog.2ffc21c8.js";import"./vendor-tone-Content.9808c346.js";import"./vendor-tone-context.2287e470.js";import"./vendor-tone-SubMenu.1b0c3984.js";import"./vendor-tone-Popup.9ff27a32.js";import"./vendor-tone-SingleObserver.ddf11abe.js";import"./vendor-tone-icons.388eb8da.js";import"./vendor-tone-asn.f94d41fd.js";import"./vendor-tone-message.06244fbe.js";import"./vendor-tone-config-provider.2fc53c46.js";import"./vendor-tone-form.6dd4e248.js";import"./vendor-tone-grid.9235ce83.js";import"./vendor-tone-locale-provider.8d53e5b8.js";import"./vendor-tone-modal.4772d80b.js";import"./vendor-tone-button.429dcaea.js";import"./vendor-tone-space.95ee87ca.js";import"./vendor-tone-locale.9bc1cdd3.js";import"./vendor-tone-useModal.b905cda5.js";import"./vendor-tone-tooltip.4e7d946d.js";import"./vendor-tone-FormItem.7dbdfc6f.js";import"./vendor-tone-notification.2961f1bd.js";import"./vendor-tone-empty.6f888680.js";import"./vendor-tone-channel.a150b5c9.js";import"./vendor-tone-menu.86d2dba0.js";import"./vendor-tone-layout.4cbd4c32.js";import"./vendor-tone-useMediaQuery.95247262.js";import"./vendor-tone-useThemeProps.a5833127.js";import"./vendor-tone-validation.226ee14c.js";import"./vendor-tone-LocalizationProvider.b505657c.js";import"./vendor-tone-locales.e8ab67da.js";import"./vendor-tone-RtlProvider.df0b182e.js";import"./vendor-tone-constants.d67dcaf6.js";import"./vendor-mui-dialogs.59185291.js";import"./vendor-tone-env.26551821.js";import"./vendor-react-props.65efe0a6.js";import"./vendor-tone-system.c96386b3.js";import"./vendor-mui-list.1c6188a6.js";import"./vendor-tone-Stack.f8b60d0c.js";import"./vendor-mui-menus.328affd2.js";import"./vendor-tone-DefaultPropsProvider.3d25d93b.js";import"./vendor-tone-Container.5ed3ed7d.js";function u({children:e,value:i,index:s,...n}){return t.jsx("div",{role:"tabpanel",hidden:i!==s,id:`physics-tabpanel-${s}`,"aria-labelledby":`physics-tab-${s}`,...n,children:i===s&&t.jsx(m,{sx:{p:3},children:e})})}function y(e){return{id:`physics-tab-${e}`,"aria-controls":`physics-tabpanel-${e}`}}function g({entityType:g,entityId:b}){const[_,f]=e.useState(0),[C,D]=e.useState(null),[S,P]=e.useState(null),[$,B]=e.useState([]),[w,k]=e.useState([]),[F,L]=e.useState(!0),[T,z]=e.useState(null),[N,A]=e.useState(!0),O=i();e.useEffect((()=>{b&&(async()=>{L(!0);try{let e;e=await fetch(`/api/physics/2d?${g}_id=${b}`);const t=await e.json();t.success&&t.data.length>0&&D(t.data[0]),e=await fetch(`/api/physics/3d?${g}_id=${b}`);const i=await e.json();i.success&&i.data.length>0&&P(i.data[0]),e=await fetch(`/api/physics/objects?${g}_id=${b}`);const s=await e.json();if(s.success&&B(s.data),"scene"===g){e=await fetch(`/api/physics/constraints?scene_id=${b}`);const t=await e.json();t.success&&k(t.data)}e=await fetch(`/api/${g}s/${b}`);const n=await e.json();n.success&&A(!1!==n.data.is_2d)}catch(e){z("Error loading physics data: "+e.message)}finally{L(!1)}})()}),[g,b]);const E=e=>{const{name:t,value:i,type:s,checked:n}=e.target;D((e=>({...e,[t]:"checkbox"===s?n:i})))},W=e=>{const{name:t,value:i,type:s,checked:n}=e.target;P((e=>({...e,[t]:"checkbox"===s?n:i})))};return F?t.jsx(s,{children:"Loading physics data..."}):t.jsxs(m,{sx:{width:"100%"},children:[t.jsx(m,{sx:{borderBottom:1,borderColor:"divider"},children:t.jsxs(n,{value:_,onChange:(e,t)=>{f(t)},"aria-label":"physics tabs",children:[t.jsx(o,{label:"Physics Settings",...y(0)}),t.jsx(o,{label:"Objects",...y(1)}),"scene"===g&&t.jsx(o,{label:"Constraints",...y(2)})]})}),T&&t.jsx(r,{severity:"error",sx:{mt:2},children:T}),t.jsxs(u,{value:_,index:0,children:[t.jsxs(m,{sx:{mb:2},children:[t.jsx(p,{control:t.jsx(a,{checked:N,onChange:()=>A(!N)}),label:N?"2D Physics":"3D Physics"}),t.jsx(s,{variant:"caption",display:"block",children:"Set the physics mode to 2D or 3D. This affects how physics calculations are performed."})]}),N?t.jsx(v,{variant:"outlined",children:t.jsxs(h,{children:[t.jsx(s,{variant:"h6",gutterBottom:!0,children:"2D Physics Settings"}),C?t.jsxs(c,{container:!0,spacing:2,children:[t.jsx(c,{item:!0,xs:12,sm:6,children:t.jsx(j,{fullWidth:!0,label:"Name",name:"name",value:C.name||"",onChange:E,margin:"normal"})}),t.jsx(c,{item:!0,xs:12,children:t.jsx(j,{fullWidth:!0,label:"Description",name:"description",value:C.description||"",onChange:E,margin:"normal",multiline:!0,rows:2})}),t.jsxs(c,{item:!0,xs:12,sm:6,children:[t.jsxs(s,{id:"gravity-x-slider",gutterBottom:!0,children:["Gravity X: ",C.gravity_x]}),t.jsx(l,{name:"gravity_x",value:parseFloat(C.gravity_x)||0,onChange:(e,t)=>D((e=>({...e,gravity_x:t}))),min:-20,max:20,step:.1,valueLabelDisplay:"auto","aria-labelledby":"gravity-x-slider"})]}),t.jsxs(c,{item:!0,xs:12,sm:6,children:[t.jsxs(s,{id:"gravity-y-slider",gutterBottom:!0,children:["Gravity Y: ",C.gravity_y]}),t.jsx(l,{name:"gravity_y",value:parseFloat(C.gravity_y)||0,onChange:(e,t)=>D((e=>({...e,gravity_y:t}))),min:-20,max:20,step:.1,valueLabelDisplay:"auto","aria-labelledby":"gravity-y-slider"})]}),t.jsxs(c,{item:!0,xs:12,sm:6,children:[t.jsxs(s,{id:"friction-slider",gutterBottom:!0,children:["Friction: ",C.friction]}),t.jsx(l,{name:"friction",value:parseFloat(C.friction)||0,onChange:(e,t)=>D((e=>({...e,friction:t}))),min:0,max:1,step:.01,valueLabelDisplay:"auto","aria-labelledby":"friction-slider"})]}),t.jsxs(c,{item:!0,xs:12,sm:6,children:[t.jsxs(s,{id:"restitution-slider",gutterBottom:!0,children:["Restitution (Bounce): ",C.restitution]}),t.jsx(l,{name:"restitution",value:parseFloat(C.restitution)||0,onChange:(e,t)=>D((e=>({...e,restitution:t}))),min:0,max:1,step:.01,valueLabelDisplay:"auto","aria-labelledby":"restitution-slider"})]}),t.jsxs(c,{item:!0,xs:12,sm:6,children:[t.jsxs(s,{id:"linear-damping-slider",gutterBottom:!0,children:["Linear Damping: ",C.linear_damping]}),t.jsx(l,{name:"linear_damping",value:parseFloat(C.linear_damping)||0,onChange:(e,t)=>D((e=>({...e,linear_damping:t}))),min:0,max:1,step:.01,valueLabelDisplay:"auto","aria-labelledby":"linear-damping-slider"})]}),t.jsxs(c,{item:!0,xs:12,sm:6,children:[t.jsxs(s,{id:"angular-damping-slider",gutterBottom:!0,children:["Angular Damping: ",C.angular_damping]}),t.jsx(l,{name:"angular_damping",value:parseFloat(C.angular_damping)||0,onChange:(e,t)=>D((e=>({...e,angular_damping:t}))),min:0,max:1,step:.01,valueLabelDisplay:"auto","aria-labelledby":"angular-damping-slider"})]}),t.jsxs(c,{item:!0,xs:12,sm:6,children:[t.jsxs(s,{id:"time-scale-slider",gutterBottom:!0,children:["Time Scale: ",C.time_scale,"x"]}),t.jsx(l,{name:"time_scale",value:parseFloat(C.time_scale)||1,onChange:(e,t)=>D((e=>({...e,time_scale:t}))),min:.1,max:2,step:.1,valueLabelDisplay:"auto","aria-labelledby":"time-scale-slider"})]}),t.jsx(c,{item:!0,xs:12,children:t.jsx(x,{variant:"contained",color:"primary",onClick:async()=>{try{const e=C.id?"PUT":"POST",t=C.id?`/api/physics/2d/${C.id}`:"/api/physics/2d",i=await fetch(t,{method:e,headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify(C)}),s=await i.json();s.success?(D(s.data),z(null)):z(s.error||"Failed to save 2D physics settings")}catch(e){z("Error saving 2D physics settings: "+e.message)}},sx:{mt:2},children:"Save 2D Physics Settings"})})]}):t.jsxs(m,{sx:{my:2},children:[t.jsxs(s,{children:["No 2D physics settings found for this ",g,"."]}),t.jsx(x,{variant:"contained",onClick:()=>{D({name:`${g.charAt(0).toUpperCase()+g.slice(1)} Physics`,description:`2D physics for this ${g}`,gravity_x:0,gravity_y:9.8,friction:.1,restitution:.5,linear_damping:.1,angular_damping:.1,time_scale:1,[`${g}_id`]:b})},sx:{mt:1},children:"Create New"})]})]})}):t.jsx(v,{variant:"outlined",children:t.jsxs(h,{children:[t.jsx(s,{variant:"h6",gutterBottom:!0,children:"3D Physics Settings"}),S?t.jsxs(c,{container:!0,spacing:2,children:[t.jsx(c,{item:!0,xs:12,sm:6,children:t.jsx(j,{fullWidth:!0,label:"Name",name:"name",value:S.name||"",onChange:W,margin:"normal"})}),t.jsx(c,{item:!0,xs:12,children:t.jsx(j,{fullWidth:!0,label:"Description",name:"description",value:S.description||"",onChange:W,margin:"normal",multiline:!0,rows:2})}),t.jsx(c,{item:!0,xs:12,children:t.jsx(s,{variant:"subtitle1",gutterBottom:!0,children:"Gravity"})}),t.jsxs(c,{item:!0,xs:12,sm:4,children:[t.jsxs(s,{id:"gravity-x-slider-3d",gutterBottom:!0,children:["X: ",S.gravity_x]}),t.jsx(l,{name:"gravity_x",value:parseFloat(S.gravity_x)||0,onChange:(e,t)=>P((e=>({...e,gravity_x:t}))),min:-20,max:20,step:.1,valueLabelDisplay:"auto","aria-labelledby":"gravity-x-slider-3d"})]}),t.jsxs(c,{item:!0,xs:12,sm:4,children:[t.jsxs(s,{id:"gravity-y-slider-3d",gutterBottom:!0,children:["Y: ",S.gravity_y]}),t.jsx(l,{name:"gravity_y",value:parseFloat(S.gravity_y)||0,onChange:(e,t)=>P((e=>({...e,gravity_y:t}))),min:-20,max:20,step:.1,valueLabelDisplay:"auto","aria-labelledby":"gravity-y-slider-3d"})]}),t.jsxs(c,{item:!0,xs:12,sm:4,children:[t.jsxs(s,{id:"gravity-z-slider-3d",gutterBottom:!0,children:["Z: ",S.gravity_z]}),t.jsx(l,{name:"gravity_z",value:parseFloat(S.gravity_z)||0,onChange:(e,t)=>P((e=>({...e,gravity_z:t}))),min:-20,max:20,step:.1,valueLabelDisplay:"auto","aria-labelledby":"gravity-z-slider-3d"})]}),t.jsxs(c,{item:!0,xs:12,children:[t.jsx(d,{sx:{mt:1,mb:2}}),t.jsx(s,{variant:"subtitle1",gutterBottom:!0,children:"Material Properties"})]}),t.jsxs(c,{item:!0,xs:12,sm:6,children:[t.jsxs(s,{id:"friction-slider-3d",gutterBottom:!0,children:["Friction: ",S.friction]}),t.jsx(l,{name:"friction",value:parseFloat(S.friction)||0,onChange:(e,t)=>P((e=>({...e,friction:t}))),min:0,max:1,step:.01,valueLabelDisplay:"auto","aria-labelledby":"friction-slider-3d"})]}),t.jsxs(c,{item:!0,xs:12,sm:6,children:[t.jsxs(s,{id:"restitution-slider-3d",gutterBottom:!0,children:["Restitution (Bounce): ",S.restitution]}),t.jsx(l,{name:"restitution",value:parseFloat(S.restitution)||0,onChange:(e,t)=>P((e=>({...e,restitution:t}))),min:0,max:1,step:.01,valueLabelDisplay:"auto","aria-labelledby":"restitution-slider-3d"})]}),t.jsxs(c,{item:!0,xs:12,children:[t.jsx(d,{sx:{mt:1,mb:2}}),t.jsx(s,{variant:"subtitle1",gutterBottom:!0,children:"Advanced Settings"})]}),t.jsxs(c,{item:!0,xs:12,sm:6,children:[t.jsxs(s,{id:"collision-margin-slider",gutterBottom:!0,children:["Collision Margin: ",S.collision_margin]}),t.jsx(l,{name:"collision_margin",value:parseFloat(S.collision_margin)||0,onChange:(e,t)=>P((e=>({...e,collision_margin:t}))),min:0,max:.1,step:.001,valueLabelDisplay:"auto","aria-labelledby":"collision-margin-slider"})]}),t.jsxs(c,{item:!0,xs:12,sm:6,children:[t.jsxs(s,{id:"time-scale-slider-3d",gutterBottom:!0,children:["Time Scale: ",S.time_scale,"x"]}),t.jsx(l,{name:"time_scale",value:parseFloat(S.time_scale)||1,onChange:(e,t)=>P((e=>({...e,time_scale:t}))),min:.1,max:2,step:.1,valueLabelDisplay:"auto","aria-labelledby":"time-scale-slider-3d"})]}),t.jsx(c,{item:!0,xs:12,sm:6,children:t.jsx(j,{fullWidth:!0,label:"Solver Iterations",name:"solver_iterations",type:"number",value:S.solver_iterations||10,onChange:W,margin:"normal",inputProps:{min:1,max:50}})}),t.jsx(c,{item:!0,xs:12,sm:6,children:t.jsx(j,{fullWidth:!0,label:"Substeps",name:"substeps",type:"number",value:S.substeps||2,onChange:W,margin:"normal",inputProps:{min:1,max:10}})}),t.jsx(c,{item:!0,xs:12,children:t.jsx(p,{control:t.jsx(a,{checked:!0===S.continuous_detection,onChange:e=>P((t=>({...t,continuous_detection:e.target.checked}))),name:"continuous_detection"}),label:"Continuous Collision Detection"})}),t.jsx(c,{item:!0,xs:12,children:t.jsx(x,{variant:"contained",color:"primary",onClick:async()=>{try{const e=S.id?"PUT":"POST",t=S.id?`/api/physics/3d/${S.id}`:"/api/physics/3d",i=await fetch(t,{method:e,headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify(S)}),s=await i.json();s.success?(P(s.data),z(null)):z(s.error||"Failed to save 3D physics settings")}catch(e){z("Error saving 3D physics settings: "+e.message)}},sx:{mt:2},children:"Save 3D Physics Settings"})})]}):t.jsxs(m,{sx:{my:2},children:[t.jsxs(s,{children:["No 3D physics settings found for this ",g,"."]}),t.jsx(x,{variant:"contained",onClick:()=>{P({name:`${g.charAt(0).toUpperCase()+g.slice(1)} Physics`,description:`3D physics for this ${g}`,gravity_x:0,gravity_y:-9.8,gravity_z:0,friction:.3,restitution:.5,linear_damping:.05,angular_damping:.05,collision_margin:.04,continuous_detection:!0,substeps:2,solver_iterations:10,time_scale:1,[`${g}_id`]:b})},sx:{mt:1},children:"Create New"})]})]})})]}),t.jsxs(u,{value:_,index:1,children:[t.jsx(s,{variant:"h6",gutterBottom:!0,children:"Physics Objects"}),t.jsx(m,{sx:{mb:2},children:t.jsx(x,{variant:"contained",onClick:()=>O(`/${g}s/${b}/physics/objects/new`),children:"Add New Object"})}),0===$.length?t.jsx(s,{children:"No physics objects found. Add some to enable physics interactions."}):t.jsx(c,{container:!0,spacing:2,children:$.map((e=>t.jsx(c,{item:!0,xs:12,sm:6,md:4,children:t.jsx(v,{variant:"outlined",children:t.jsxs(h,{children:[t.jsx(s,{variant:"h6",children:e.name}),t.jsxs(s,{variant:"body2",color:"text.secondary",children:[e.object_type," (",e.is_2d?"2D":"3D",")"]}),t.jsx(s,{variant:"body2",children:e.is_static?"Static (Immovable)":"Dynamic"}),t.jsx(x,{variant:"outlined",size:"small",sx:{mt:1},onClick:()=>O(`/${g}s/${b}/physics/objects/${e.id}`),children:"Edit"})]})})},e.id)))})]}),"scene"===g&&t.jsxs(u,{value:_,index:2,children:[t.jsx(s,{variant:"h6",gutterBottom:!0,children:"Physics Constraints"}),t.jsx(m,{sx:{mb:2},children:t.jsx(x,{variant:"contained",onClick:()=>O(`/scenes/${b}/physics/constraints/new`),children:"Add New Constraint"})}),0===w.length?t.jsx(s,{children:"No physics constraints found. Constraints connect objects together with various joint types."}):t.jsx(c,{container:!0,spacing:2,children:w.map((e=>t.jsx(c,{item:!0,xs:12,sm:6,md:4,children:t.jsx(v,{variant:"outlined",children:t.jsxs(h,{children:[t.jsx(s,{variant:"h6",children:e.name}),t.jsx(s,{variant:"body2",color:"text.secondary",children:e.constraint_type}),t.jsx(x,{variant:"outlined",size:"small",sx:{mt:1},onClick:()=>O(`/scenes/${b}/physics/constraints/${e.id}`),children:"Edit"})]})})},e.id)))})]})]})}export{g as default};
