import{a as e}from"./vendor-redux-toolkit.fa18e013.js";import{f as r,a,c as s,u as d,d as l,h as n,j as i,i as o,b as t,e as u,g as c}from"./app-redux-physics-thunks.c58b7b1a.js";const p={universes:[],loading:!1,error:null,currentUniverse:null,lastFetched:null,authError:!1,sortBy:"updated_at",sortOrder:"desc",success:!1},y=e({name:"universe",initialState:p,reducers:{setCurrentUniverse:(e,r)=>{if(e.currentUniverse=r.payload,e.universes.length>0){const a=e.universes.findIndex((e=>e.id===r.payload.id));-1!==a&&(e.universes[a]=r.payload)}},clearError:e=>{e.error=null,e.authError=!1},resetState:()=>p,clearAuthError:e=>{e.authError=!1},setSortBy:(e,r)=>{e.sortBy=r.payload},setSortOrder:(e,r)=>{e.sortOrder=r.payload},sortUniverses:e=>{const r=e.sortBy,a=e.sortOrder;e.universes.sort(((e,s)=>{let d=0;switch(r){case"name":d=e.name.localeCompare(s.name);break;case"created_at":d=new Date(e.created_at)-new Date(s.created_at);break;case"updated_at":d=new Date(e.updated_at)-new Date(s.updated_at);break;case"is_public":d=e.is_public===s.is_public?0:e.is_public?-1:1;break;default:d=0}return"desc"===a?-d:d}))},clearUniverseError(e){e.error=null},clearUniverseSuccess(e){e.success=!1},resetUniverseState:e=>p},extraReducers:e=>{e.addCase(r.pending,(e=>{e.loading=!0,e.error=null,e.authError=!1})).addCase(r.fulfilled,((e,r)=>{var a;e.loading=!1;let s=[];s=Array.isArray(r.payload)?r.payload:r.payload.universes&&Array.isArray(r.payload.universes)?r.payload.universes:r.payload.data&&Array.isArray(r.payload.data.universes)||"success"===r.payload.status&&(null==(a=r.payload.data)?void 0:a.universes)?r.payload.data.universes:[],e.universes=s,e.lastFetched=Date.now(),e.error=null,e.authError=!1})).addCase(r.rejected,((e,r)=>{var a,s,d;e.loading=!1,e.error=(null==(a=r.payload)?void 0:a.message)||r.payload||"Failed to fetch universes",e.authError=401===(null==(s=r.payload)?void 0:s.status)||403===(null==(d=r.payload)?void 0:d.status),e.authError&&(e.universes=[])})).addCase(a.pending,(e=>{e.loading=!0,e.error=null})).addCase(a.fulfilled,((e,r)=>{var a;e.loading=!1,e.currentUniverse=null==(a=r.payload)?void 0:a.universe})).addCase(a.rejected,((e,r)=>{e.loading=!1,e.error=r.payload||"Failed to fetch universe"})).addCase(s.pending,(e=>{e.loading=!0,e.error=null,e.success=!1})).addCase(s.fulfilled,((e,r)=>{var a,s;if(e.loading=!1,e.success=!0,r.payload){let d=null;d="success"===(null==(a=r.payload.data)?void 0:a.status)&&(null==(s=r.payload.data)?void 0:s.universe)?r.payload.data.universe:r.payload.universe&&"object"==typeof r.payload.universe?r.payload.universe:r.payload.data&&r.payload.data.universe?r.payload.data.universe:r.payload.id?r.payload:r.payload.universes&&Array.isArray(r.payload.universes)&&r.payload.universes.length>0?r.payload.universes[0]:null,d&&(Array.isArray(e.universes)||(e.universes=[]),e.universes=[d,...e.universes],e.currentUniverse=d)}e.error=null,e.authError=!1})).addCase(s.rejected,((e,r)=>{var a;e.loading=!1,e.error=(null==(a=r.payload)?void 0:a.message)||r.payload||"Failed to create universe",e.success=!1})).addCase(d.pending,(e=>{e.loading=!0,e.error=null,e.success=!1})).addCase(d.fulfilled,((e,r)=>{var a,s;e.loading=!1,e.success=!0;const d=null==(a=r.payload)?void 0:a.universe;d&&(e.universes=e.universes.map((e=>e.id===d.id?d:e)),(null==(s=e.currentUniverse)?void 0:s.id)===d.id&&(e.currentUniverse=d)),e.error=null,e.authError=!1})).addCase(d.rejected,((e,r)=>{var a;e.loading=!1,e.error=(null==(a=r.payload)?void 0:a.message)||r.payload||"Failed to update universe",e.success=!1})).addCase(l.pending,(e=>{e.loading=!0,e.error=null,e.success=!1})).addCase(l.fulfilled,((e,r)=>{e.loading=!1,e.success=!0;const a=r.meta.arg;e.universes.length;e.universes=e.universes.filter((e=>String(e.id)!==String(a)));e.universes.length;e.currentUniverse&&String(e.currentUniverse.id)===String(a)&&(e.currentUniverse=null),e.error=null,e.authError=!1})).addCase(l.rejected,((e,r)=>{var a,s,d;e.loading=!1,(null==(s=null==(a=r.payload)?void 0:a.data)?void 0:s.error)?e.error=`Failed to delete universe: ${r.payload.data.error}`:(null==(d=r.payload)?void 0:d.message)?e.error=`Failed to delete universe: ${r.payload.message}`:"string"==typeof r.payload?e.error=`Failed to delete universe: ${r.payload}`:e.error="Failed to delete universe. Please try again.",e.success=!1})).addCase(n.pending,(e=>{e.loading=!0,e.error=null})).addCase(n.fulfilled,((e,r)=>{var a;if(e.loading=!1,e.error=null,!r.payload||!r.payload.physics_params)return;const s=r.payload;(null==(a=e.currentUniverse)?void 0:a.id)===s.id&&(e.currentUniverse=s),e.universes=e.universes.map((e=>e.id===s.id?s:e))})).addCase(n.rejected,((e,r)=>{e.loading=!1,e.error=r.payload||"Failed to update physics parameters"})).addCase(i.pending,(e=>{e.loading=!0,e.error=null})).addCase(i.fulfilled,((e,r)=>{var a;if(e.loading=!1,e.error=null,!r.payload||!r.payload.harmony_params)return;const s=r.payload;(null==(a=e.currentUniverse)?void 0:a.id)===s.id&&(e.currentUniverse=s),e.universes=e.universes.map((e=>e.id===s.id?s:e))})).addCase(i.rejected,((e,r)=>{e.loading=!1,e.error=r.payload||"Failed to update harmony parameters"}))}}).reducer,v={physicsObjects:[],currentPhysicsObject:null,loading:!1,error:null},g=e({name:"physicsObjects",initialState:v,reducers:{setCurrentPhysicsObject:(e,r)=>{e.currentPhysicsObject=r.payload},clearCurrentPhysicsObject:e=>{e.currentPhysicsObject=null},clearError:e=>{e.error=null},resetState:()=>v},extraReducers:e=>{e.addCase(o.pending,(e=>{e.loading=!0,e.error=null})).addCase(o.fulfilled,((e,r)=>{e.loading=!1,e.physicsObjects=r.payload,e.error=null})).addCase(o.rejected,((e,r)=>{e.loading=!1,e.error=r.payload})).addCase(t.pending,(e=>{e.loading=!0,e.error=null})).addCase(t.fulfilled,((e,r)=>{e.loading=!1,e.physicsObjects.push(r.payload),e.currentPhysicsObject=r.payload,e.error=null})).addCase(t.rejected,((e,r)=>{e.loading=!1,e.error=r.payload})).addCase(u.pending,(e=>{e.loading=!0,e.error=null})).addCase(u.fulfilled,((e,r)=>{var a;e.loading=!1;const s=e.physicsObjects.findIndex((e=>e.id===r.payload.id));-1!==s&&(e.physicsObjects[s]=r.payload),(null==(a=e.currentPhysicsObject)?void 0:a.id)===r.payload.id&&(e.currentPhysicsObject=r.payload),e.error=null})).addCase(u.rejected,((e,r)=>{e.loading=!1,e.error=r.payload})).addCase(c.pending,(e=>{e.loading=!0,e.error=null})).addCase(c.fulfilled,((e,r)=>{var a;e.loading=!1,e.physicsObjects=e.physicsObjects.filter((e=>e.id!==r.payload)),(null==(a=e.currentPhysicsObject)?void 0:a.id)===r.payload&&(e.currentPhysicsObject=null),e.error=null})).addCase(c.rejected,((e,r)=>{e.loading=!1,e.error=r.payload}))}}),{setCurrentPhysicsObject:h,clearCurrentPhysicsObject:C,clearError:f,resetState:j}=g.actions;export{h as s,y as u};
