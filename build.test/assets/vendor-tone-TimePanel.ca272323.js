import{k as e,j as n,i as t,_ as o}from"./vendor-tone-esm.8edb30e2.js";import{r}from"./vendor-react-core.73efc664.js";import{c as a}from"./vendor-tone-classnames.ea5eadd4.js";import{H as u}from"./vendor-tone-panels.35d19878.js";import{P as i}from"./vendor-tone-es.9387ac1c.js";import{a4 as s,aF as l,aG as c,aH as f,aI as d,a5 as v}from"./vendor-tone-util.a79eb63f.js";import{F as m}from"./vendor-tone-hooks.ee856eec.js";function p(e){if(r.useContext(i).hideHeader)return null;var n=e.prefixCls,t=e.generateConfig,o=e.locale,a=e.value,l=e.format,c="".concat(n,"-header");return r.createElement(u,{prefixCls:c},a?s(a,{locale:o,format:l,generateConfig:t}):"Â ")}function b(n){var t=n.prefixCls,o=n.units,u=n.onSelect,s=n.value,f=n.active,d=n.hideDisabledOptions,v="".concat(t,"-cell"),m=r.useContext(i).open,p=r.useRef(null),b=r.useRef(new Map),h=r.useRef();return r.useLayoutEffect((function(){var e=b.current.get(s);e&&!1!==m&&l(p.current,e.offsetTop,120)}),[s]),r.useLayoutEffect((function(){if(m){var e=b.current.get(s);e&&(h.current=c(e,(function(){l(p.current,e.offsetTop,0)})))}return function(){var e;null===(e=h.current)||void 0===e||e.call(h)}}),[m]),r.createElement("ul",{className:a("".concat(t,"-column"),e({},"".concat(t,"-column-active"),f)),ref:p,style:{position:"relative"}},o.map((function(n){var t;return d&&n.disabled?null:r.createElement("li",{key:n.value,ref:function(e){b.current.set(n.value,e)},className:a(v,(t={},e(t,"".concat(v,"-disabled"),n.disabled),e(t,"".concat(v,"-selected"),s===n.value),t)),onClick:function(){n.disabled||u(n.value)}},r.createElement("div",{className:"".concat(v,"-inner")},n.label))})))}function h(e,n){if(e.length!==n.length)return!0;for(var t=0;t<e.length;t+=1)if(e[t].disabled!==n[t].disabled)return!0;return!1}function g(e,n,t,o){for(var r=[],a=t>=1?0|t:1,u=e;u<=n;u+=a)r.push({label:d(u,2),value:u,disabled:(o||[]).includes(u)});return r}function C(e){var o,a=e.generateConfig,u=e.prefixCls,i=e.operationRef,s=e.activeColumnIndex,l=e.value,c=e.showHour,v=e.showMinute,p=e.showSecond,C=e.use12Hours,E=e.hourStep,S=void 0===E?1:E,x=e.minuteStep,w=void 0===x?1:x,H=e.secondStep,M=void 0===H?1:H,y=e.disabledHours,k=e.disabledMinutes,j=e.disabledSeconds,R=e.disabledTime,D=e.hideDisabledOptions,N=e.onSelect,T=[],I="".concat(u,"-content"),U="".concat(u,"-time-panel"),F=l?a.getHour(l):-1,L=F,O=l?a.getMinute(l):-1,P=l?a.getSecond(l):-1,A=a.getNow(),B=r.useMemo((function(){if(R){var e=R(A);return[e.disabledHours,e.disabledMinutes,e.disabledSeconds]}return[y,k,j]}),[y,k,j,R,A]),G=n(B,3),K=G[0],Y=G[1],_=G[2],q=g(0,23,S,K&&K()),z=f((function(){return q}),q,h);C&&(o=L>=12,L%=12);var J=r.useMemo((function(){if(!C)return[!1,!1];var e=[!0,!0];return z.forEach((function(n){var t=n.disabled,o=n.value;t||(o>=12?e[1]=!1:e[0]=!1)})),e}),[C,z]),Q=n(J,2),V=Q[0],W=Q[1],X=r.useMemo((function(){return C?z.filter(o?function(e){return e.value>=12}:function(e){return e.value<12}).map((function(e){var n=e.value%12,o=0===n?"12":d(n,2);return t(t({},e),{},{label:o,value:n})})):z}),[C,o,z]),Z=g(0,59,w,Y&&Y(F)),$=g(0,59,M,_&&_(F,O)),ee=m({value:l,generateConfig:a,disabledMinutes:Y,disabledSeconds:_,minutes:Z,seconds:$,use12Hours:C});function ne(e,n,t,o,a){!1!==e&&T.push({node:r.cloneElement(n,{prefixCls:U,value:t,active:s===T.length,onSelect:a,units:o,hideDisabledOptions:D}),onSelect:a,value:t,units:o})}i.current={onUpDown:function(e){var n=T[s];if(n)for(var t=n.units.findIndex((function(e){return e.value===n.value})),o=n.units.length,r=1;r<o;r+=1){var a=n.units[(t+e*r+o)%o];if(!0!==a.disabled){n.onSelect(a.value);break}}}},ne(c,r.createElement(b,{key:"hour"}),L,X,(function(e){N(ee(o,e,O,P),"mouse")})),ne(v,r.createElement(b,{key:"minute"}),O,Z,(function(e){N(ee(o,L,e,P),"mouse")})),ne(p,r.createElement(b,{key:"second"}),P,$,(function(e){N(ee(o,L,O,e),"mouse")}));var te=-1;return"boolean"==typeof o&&(te=o?1:0),ne(!0===C,r.createElement(b,{key:"12hours"}),te,[{label:"AM",value:0,disabled:V},{label:"PM",value:1,disabled:W}],(function(e){N(ee(!!e,L,O,P),"mouse")})),r.createElement("div",{className:I},T.map((function(e){return e.node})))}function E(t){var u=t.generateConfig,i=t.format,s=void 0===i?"HH:mm:ss":i,l=t.prefixCls,c=t.active,f=t.operationRef,d=t.showHour,m=t.showMinute,b=t.showSecond,h=t.use12Hours,g=void 0!==h&&h,E=t.onSelect,S=t.value,x="".concat(l,"-time-panel"),w=r.useRef(),H=r.useState(-1),M=n(H,2),y=M[0],k=M[1],j=[d,m,b,g].filter((function(e){return!1!==e})).length;return f.current={onKeyDown:function(e){return v(e,{onLeftRight:function(e){k((y+e+j)%j)},onUpDown:function(e){-1===y?k(0):w.current&&w.current.onUpDown(e)},onEnter:function(){E(S||u.getNow(),"key"),k(-1)}})},onBlur:function(){k(-1)}},r.createElement("div",{className:a(x,e({},"".concat(x,"-active"),c))},r.createElement(p,o({},t,{format:s,prefixCls:l})),r.createElement(C,o({},t,{prefixCls:l,activeColumnIndex:y,operationRef:w})))}export{E as T};
