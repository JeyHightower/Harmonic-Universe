import{r as e,j as o}from"./vendor-react-core.73efc664.js";import{u as t,a as n}from"./vendor-react-redux.ca23f922.js";import{b as r,d as s}from"./app-redux-scene-thunks.d96f7130.js";import{u as i}from"./app-utils.cd93f9c5.js";import"./app-core.4fc76094.js";import{S as a}from"./app-scenes-form.07f7a30a.js";import d from"./app-services-api.399edcf9.js";import{u as c,a as p}from"./vendor-react-router.6468192e.js";import{C as m,B as l,G as j}from"./vendor-mui-layout.b03fb29f.js";import{C as v,P as u,A as h,T as x,e as y}from"./vendor-mui-core.4359195f.js";import{B as f}from"./vendor-mui-buttons.74e6c144.js";import{c as b,E as g,D as k,k as P,U as _,I as N}from"./vendor-mui-icons-other.bc15c9b6.js";import{D as S,b as D,a as C,c as I}from"./vendor-mui-dialogs.59185291.js";import"./vendor-tone-classnames.ea5eadd4.js";import"./vendor-tone-dist.6485732f.js";import"./vendor-tone-module.5bbe5778.js";import"./vendor-tone-util.a79eb63f.js";import"./vendor-tone-helpers.07e4d08d.js";import"./vendor-tone-platform.4f06f964.js";import"./vendor-tone-browser.dd42b0e8.js";import"./vendor-tone-classes.909fbaba.js";import"./vendor-tone-core-base.398f9a2a.js";import"./vendor-tone-defaults.617853c7.js";import"./vendor-tone-cancel.b93f499f.js";import"./vendor-tone-adapters.ec1cb8a7.js";import"./vendor-tone-lodash.1d9c6a83.js";import"./vendor-tone-events.9afa7530.js";import"./vendor-tone-audio.70450c41.js";import"./vendor-tone-source.0b4b1ccd.js";import"./vendor-tone-tslib.f5f62bcb.js";import"./vendor-tone-signal.648ab60f.js";import"./vendor-tone-components.680c7d7e.js";import"./vendor-tone-esm.8edb30e2.js";import"./vendor-tone-type.9e20d569.js";import"./vendor-tone-styled-engine.72d9b7d5.js";import"./vendor-emotion-styled.ae0fdb08.js";import"./vendor-emotion-core.fcf170e6.js";import"./vendor-tone-src.89c6b4f5.js";import"./vendor-tone-StyledEngineProvider.626b917c.js";import"./vendor-tone-GlobalStyles.58bf1e29.js";import"./vendor-tone-createTheme.6c673f08.js";import"./vendor-tone-styleFunctionSx.dbcb4226.js";import"./vendor-tone-instruments.3eb491c0.js";import"./vendor-tone-effects.66f8dc4e.js";import"./vendor-react-dom.e7130502.js";import"./vendor-react-scheduler.c51d43b5.js";import"./vendor-tone-hooks.ee856eec.js";import"./vendor-tone-es.9387ac1c.js";import"./vendor-tone-dist-web.442e5e08.js";import"./vendor-tone-Selector.7ca3b0ed.js";import"./vendor-tone-TimePanel.ca272323.js";import"./vendor-tone-panels.35d19878.js";import"./vendor-tone-DatetimePanel.eb5b0baf.js";import"./vendor-tone-DatePanel.9f66ebd0.js";import"./vendor-tone-WeekPanel.896778be.js";import"./vendor-tone-MonthPanel.70b7688e.js";import"./vendor-tone-QuarterPanel.144363f0.js";import"./vendor-tone-YearPanel.b92617d1.js";import"./vendor-tone-DecadePanel.8c0dc02f.js";import"./vendor-tone-TabPanelList.10481429.js";import"./vendor-tone-TabNavList.2513addc.js";import"./vendor-tone-Dialog.2ffc21c8.js";import"./vendor-tone-Content.9808c346.js";import"./vendor-tone-context.2287e470.js";import"./vendor-tone-SubMenu.1b0c3984.js";import"./vendor-tone-Popup.9ff27a32.js";import"./vendor-tone-SingleObserver.ddf11abe.js";import"./vendor-tone-icons.388eb8da.js";import"./vendor-tone-asn.f94d41fd.js";import"./vendor-tone-message.06244fbe.js";import"./vendor-tone-config-provider.2fc53c46.js";import"./vendor-tone-form.6dd4e248.js";import"./vendor-tone-grid.9235ce83.js";import"./vendor-tone-locale-provider.8d53e5b8.js";import"./vendor-tone-modal.4772d80b.js";import"./vendor-tone-button.429dcaea.js";import"./vendor-tone-space.95ee87ca.js";import"./vendor-tone-locale.9bc1cdd3.js";import"./vendor-tone-useModal.b905cda5.js";import"./vendor-tone-tooltip.4e7d946d.js";import"./vendor-tone-FormItem.7dbdfc6f.js";import"./vendor-tone-notification.2961f1bd.js";import"./vendor-tone-empty.6f888680.js";import"./vendor-tone-channel.a150b5c9.js";import"./vendor-tone-menu.86d2dba0.js";import"./vendor-tone-layout.4cbd4c32.js";import"./vendor-tone-useMediaQuery.95247262.js";import"./vendor-tone-useThemeProps.a5833127.js";import"./vendor-mui-inputs.b77362ac.js";import"./vendor-tone-validation.226ee14c.js";import"./vendor-tone-LocalizationProvider.b505657c.js";import"./vendor-tone-locales.e8ab67da.js";import"./vendor-tone-RtlProvider.df0b182e.js";import"./vendor-tone-constants.d67dcaf6.js";import"./vendor-tone-env.26551821.js";import"./vendor-react-props.65efe0a6.js";import"./vendor-tone-shim.e999ecad.js";import"./vendor-tone-cjs.5d603e0b.js";import"./vendor-tone-use-sync-external-store-shim.d3746bbc.js";import"./vendor-redux-toolkit.fa18e013.js";import"./vendor-redux-core.f9606c35.js";import"./app-redux-scene-slice.81f21730.js";import"./vendor-tone-lib.58935e90.js";import"./app-constants.4a812be2.js";import"./app-modals.11788519.js";import"./app-other-components.5e297c7e.js";import"./app-contexts.6347d155.js";import"./app-redux-other-slices.a7022ed8.js";import"./app-redux-auth-thunks.3612091e.js";import"./app-redux-auth-slice.749a10ad.js";import"./app-redux-note-slice.2ed79aa2.js";import"./app-redux-note-thunks.e47bcfeb.js";import"./vendor-mui-card.3348f8fd.js";import"./app-redux-character-slice.77cb9e4b.js";import"./app-redux-character-thunks.c46623e8.js";import"./app-characters-components.a508a592.js";import"./vendor-tone-select.c6c7620f.js";import"./vendor-tone-spin.d13f75fd.js";import"./vendor-tone-avatar.122bfb6a.js";import"./vendor-tone-popover.9c9808a5.js";import"./app-redux-physics-thunks.c58b7b1a.js";import"./vendor-mui-menus.328affd2.js";import"./vendor-mui-list.1c6188a6.js";import"./vendor-tone-system.c96386b3.js";import"./vendor-tone-upload.27f9a3b5.js";import"./vendor-tone-UploadList.9372bedd.js";import"./vendor-tone-progress.cc741b51.js";import"./vendor-tone-card.8385b307.js";import"./vendor-tone-skeleton.45affeec.js";import"./vendor-tone-tabs.69cd71fe.js";import"./vendor-tone-switch.4218e0a6.js";import"./app-scenes-components.e3ba29e5.js";import"./app-services-other.47edd63d.js";import"./app-physics-components.dcafff4c.js";import"./app-physics-list.9dc0d346.js";import"./app-redux-physics-slice.b0d37703.js";import"./vendor-tone-Stack.f8b60d0c.js";import"./vendor-tone-DefaultPropsProvider.3d25d93b.js";import"./app-redux-core.93965072.js";import"./vendor-redux-persist.1ece7284.js";import"./app-routes.fd68d670.js";import"./vendor-tone-Container.5ed3ed7d.js";import"./vendor-tone-dayjs.54e2289e.js";import"./vendor-tone-alert.89362924.js";import"./vendor-tone-input.876080ec.js";import"./vendor-tone-divider.a6c32c3c.js";import"./vendor-tone-date-picker.3f71bbe3.js";import"./vendor-tone-tag.30f4ea2f.js";import"./vendor-tone-generate.3bd3dbc2.js";import"./vendor-tone-generatePicker.e957b148.js";import"./vendor-tone-radio.0de19148.js";import"./vendor-tone-typography.2404bb54.js";import"./vendor-tone-Base.81f829aa.js";import"./vendor-tone-copy-to-clipboard.e7f533f2.js";import"./vendor-tone-toggle-selection.c563a038.js";import"./vendor-tone-DatePicker.de25fe8c.js";import"./vendor-tone-DesktopDatePicker.f7be1484.js";import"./vendor-tone-dateViewRenderers.da97565f.js";import"./vendor-tone-DateCalendar.07d8b1f1.js";import"./vendor-tone-PickersDay.36f5e5b8.js";import"./vendor-tone-PickersCalendarHeader.d19a4873.js";import"./vendor-tone-YearCalendar.53b1f79c.js";import"./vendor-tone-MonthCalendar.110ab177.js";import"./vendor-tone-DateField.a7ba308d.js";import"./vendor-tone-useField.40869926.js";import"./vendor-tone-PickersTextField.1b1b2159.js";import"./vendor-tone-PickersInput.177ec5f5.js";import"./vendor-tone-PickersInputBase.b4cbf25e.js";import"./vendor-tone-PickersSectionList.b3696c3f.js";import"./vendor-tone-PickersFilledInput.ea55e758.js";import"./vendor-tone-PickersOutlinedInput.cd7d73be.js";import"./vendor-tone-useDesktopPicker.83b3e221.js";import"./vendor-tone-usePicker.425377a1.js";import"./vendor-tone-PickersLayout.80c91798.js";import"./vendor-tone-PickersActionBar.6bdc4ff9.js";import"./vendor-tone-PickersShortcuts.51e2ec2a.js";import"./vendor-tone-MobileDatePicker.51f93f0c.js";import"./vendor-tone-useMobilePicker.b0b52352.js";import"./vendor-tone-input-number.28372503.js";const B=({isEdit:B=!1})=>{var A;const T=t(),w=c(),{sceneId:M,universeId:$}=p(),E=n((e=>e.scenes||{})),{currentScene:F,loading:L,error:z}=e.useMemo((()=>({currentScene:E.currentScene||null,loading:E.loading||!1,error:E.error||null})),[E]),W=n((e=>e.auth||{})),{user:O}=e.useMemo((()=>({user:W.user||null,isAuthenticated:W.isAuthenticated||!1})),[W]),[R,G]=e.useState(!1),[H,Q]=e.useState(!1);e.useEffect((()=>{B&&F&&Q(!0)}),[B,F]),e.useEffect((()=>{if(M){if("new"===M)return void w(`/universes/${$}/scenes/create`);try{T(r(M)).catch((e=>{var o;null==(o=e.response)||o.status}))}catch(e){}}}),[T,M,$,w]);const U=()=>{Q(!1)};if(L)return o.jsx(m,{className:"scene-detail-container",children:o.jsx(l,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"200px",children:o.jsx(v,{})})});if(z)return o.jsx(m,{maxWidth:"lg",sx:{mt:4,mb:4},children:o.jsx(u,{sx:{p:3},children:o.jsx(h,{severity:"error",children:"object"==typeof z?z.message||"An error occurred":z})})});if(!F)return o.jsx(m,{className:"scene-detail-container",children:o.jsx(h,{severity:"warning",sx:{mt:2},children:"Scene not found"})});const Y=(null==O?void 0:O.id)===(null==(A=F.universe)?void 0:A.user_id);return o.jsxs(m,{className:"scene-detail-container",children:[o.jsxs(l,{className:"scene-detail-header",children:[o.jsx(f,{variant:"outlined",startIcon:o.jsx(b,{}),onClick:()=>{try{const e=$||(null==F?void 0:F.universe_id);w(e?`/universes/${e}/scenes`:"/dashboard")}catch(e){w("/dashboard")}},sx:{mb:2},children:"Back to Scenes"}),o.jsxs(l,{className:"scene-detail-title-section",children:[o.jsx(x,{variant:"h4",component:"h1",children:F.name}),Y&&o.jsxs(l,{className:"scene-detail-actions",children:[o.jsx(f,{variant:"outlined",startIcon:o.jsx(g,{}),onClick:()=>{try{const e=$||(null==F?void 0:F.universe_id);w(e?`/universes/${e}/scenes/${M}/edit`:`/scenes/${M}/edit`)}catch(e){}},color:"primary",children:"Edit Scene"}),o.jsx(f,{variant:"outlined",color:"error",startIcon:o.jsx(k,{}),onClick:()=>G(!0),children:"Delete"})]})]})]}),o.jsxs(j,{container:!0,spacing:3,children:[o.jsxs(j,{item:!0,xs:12,md:8,children:[o.jsxs(u,{className:"scene-detail-section",children:[o.jsx(x,{variant:"h6",gutterBottom:!0,children:"Description"}),o.jsx(x,{variant:"body1",paragraph:!0,component:"div",children:F.description||"No description provided"})]}),F.summary&&o.jsxs(u,{className:"scene-detail-section",sx:{mt:2},children:[o.jsx(x,{variant:"h6",gutterBottom:!0,children:"Summary"}),o.jsx(x,{variant:"body1",paragraph:!0,component:"div",children:F.summary})]}),F.content&&o.jsxs(u,{className:"scene-detail-section",sx:{mt:2},children:[o.jsx(x,{variant:"h6",gutterBottom:!0,children:"Content"}),o.jsx(x,{variant:"body1",paragraph:!0,component:"div",children:F.content})]}),F.notes_text&&o.jsxs(u,{className:"scene-detail-section",sx:{mt:2},children:[o.jsx(x,{variant:"h6",gutterBottom:!0,children:"Notes"}),o.jsx(x,{variant:"body1",paragraph:!0,component:"div",children:F.notes_text})]}),void 0!==F.notes_count&&F.notes_count>0&&o.jsxs(u,{className:"scene-detail-section",sx:{mt:2},children:[o.jsx(x,{variant:"h6",gutterBottom:!0,children:"Notes"}),o.jsxs(x,{variant:"body1",component:"div",children:["This scene has ",F.notes_count," note",1!==F.notes_count?"s":"","."]})]}),void 0!==F.characters_count&&F.characters_count>0&&o.jsxs(u,{className:"scene-detail-section",sx:{mt:2},children:[o.jsx(x,{variant:"h6",gutterBottom:!0,children:"Characters"}),o.jsxs(x,{variant:"body1",component:"div",children:["This scene has ",F.characters_count," character",1!==F.characters_count?"s":"","."]})]})]}),o.jsxs(j,{item:!0,xs:12,md:4,children:[o.jsxs(u,{className:"scene-detail-section",children:[o.jsx(x,{variant:"h6",gutterBottom:!0,children:"Scene Details"}),o.jsxs(l,{className:"scene-detail-info",children:[o.jsxs(x,{variant:"body2",className:"date-info-item",component:"div",children:[o.jsxs("span",{children:[o.jsx(P,{fontSize:"small",sx:{verticalAlign:"middle",mr:1}})," ","Created:"]}),o.jsx("span",{children:i(F.created_at)})]}),o.jsxs(x,{variant:"body2",className:"date-info-item",component:"div",children:[o.jsxs("span",{children:[o.jsx(_,{fontSize:"small",sx:{verticalAlign:"middle",mr:1}})," ","Updated:"]}),o.jsx("span",{children:i(F.updated_at)})]}),o.jsxs(x,{variant:"body2",className:"date-info-item",component:"div",children:[o.jsxs("span",{children:[o.jsx(N,{fontSize:"small",sx:{verticalAlign:"middle",mr:1}})," ","Status:"]}),o.jsx(y,{label:F.is_active?"Active":"Inactive",size:"small",className:F.is_active?"status-active":"status-inactive"})]})]})]}),o.jsxs(u,{className:"scene-detail-section",sx:{mt:2},children:[o.jsx(x,{variant:"h6",gutterBottom:!0,children:"Additional Information"}),o.jsxs(l,{className:"scene-detail-metadata",children:[F.location&&o.jsxs(x,{variant:"body2",className:"detail-info-item",component:"div",children:[o.jsx("span",{children:"Location:"}),o.jsx("span",{children:F.location})]}),F.scene_type&&o.jsxs(x,{variant:"body2",className:"detail-info-item",component:"div",children:[o.jsx("span",{children:"Scene Type:"}),o.jsx("span",{children:F.scene_type})]}),F.time_of_day&&o.jsxs(x,{variant:"body2",className:"detail-info-item",component:"div",children:[o.jsx("span",{children:"Time of Day:"}),o.jsx("span",{children:F.time_of_day})]}),F.status&&o.jsxs(x,{variant:"body2",className:"detail-info-item",component:"div",children:[o.jsx("span",{children:"Status:"}),o.jsx("span",{children:F.status})]}),F.significance&&o.jsxs(x,{variant:"body2",className:"detail-info-item",component:"div",children:[o.jsx("span",{children:"Significance:"}),o.jsx("span",{children:F.significance})]}),F.date_of_scene&&o.jsxs(x,{variant:"body2",className:"detail-info-item",component:"div",children:[o.jsx("span",{children:"Scene Date:"}),o.jsx("span",{children:F.date_of_scene})]}),"number"==typeof F.order&&o.jsxs(x,{variant:"body2",className:"detail-info-item",component:"div",children:[o.jsx("span",{children:"Order:"}),o.jsx("span",{children:F.order})]})]})]})]})]}),o.jsxs(S,{open:R,onClose:()=>G(!1),"aria-labelledby":"delete-dialog-title",maxWidth:"xs",fullWidth:!0,children:[o.jsx(D,{id:"delete-dialog-title",children:"Delete Scene"}),o.jsx(C,{dividers:!0,children:o.jsxs(x,{children:['Are you sure you want to delete "',F.name,'"? This action cannot be undone.']})}),o.jsxs(I,{children:[o.jsx(f,{onClick:()=>G(!1),children:"Cancel"}),o.jsx(f,{onClick:async()=>{try{await T(s(M));const e=$||(null==F?void 0:F.universe_id);w(e?`/universes/${e}/scenes`:"/dashboard")}catch(e){}finally{G(!1)}},color:"error",variant:"contained",children:"Delete"})]})]}),H&&F&&o.jsxs(S,{open:H,onClose:U,maxWidth:"md",fullWidth:!0,disableEnforceFocus:!0,disableRestoreFocus:!0,closeAfterTransition:!0,"aria-labelledby":"edit-dialog-title",children:[o.jsx(D,{id:"edit-dialog-title",children:"Edit Scene"}),o.jsx(C,{dividers:!0,children:o.jsx(a,{universeId:F.universe_id,sceneId:M,initialData:F,onSubmit:async e=>{var o;try{e.universe_id||(e.universe_id=F.universe_id);const t=await d.updateScene(M,e);let n;return n=(null==(o=t.data)?void 0:o.scene)?t.data.scene:t.data?t.data:t,U(),T(r(M)),B&&w(`/universes/${F.universe_id}/scenes/${M}`),n}catch(t){throw t}},onCancel:()=>{U(),B&&w(`/universes/${F.universe_id}/scenes/${M}`)}})})]})]})};export{B as default};
