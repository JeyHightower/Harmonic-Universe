import{j as e,r}from"./vendor-react-core.73efc664.js";import{u as a}from"./vendor-react-redux.ca23f922.js";import{o as t}from"./app-redux-character-slice.77cb9e4b.js";import{d as s}from"./app-redux-character-thunks.c46623e8.js";import{C as i,a as o,b as n}from"./vendor-mui-card.3348f8fd.js";import{T as l,a as c}from"./vendor-mui-core.4359195f.js";import{B as d}from"./vendor-mui-layout.b03fb29f.js";import{I as m}from"./vendor-mui-buttons.74e6c144.js";import{V as h,E as p,D as j}from"./vendor-mui-icons-other.bc15c9b6.js";import"./app-redux-other-slices.a7022ed8.js";import"./app-utils.cd93f9c5.js";import u from"./app-services-api.399edcf9.js";import{S as x}from"./vendor-tone-select.c6c7620f.js";import{S as y}from"./vendor-tone-spin.d13f75fd.js";import{E as f}from"./vendor-tone-empty.6f888680.js";import{A as v}from"./vendor-tone-avatar.122bfb6a.js";import{U as g}from"./vendor-tone-icons.388eb8da.js";const C=({character:r})=>{const u=a();return e.jsxs(i,{className:"character-card",children:[e.jsxs(o,{children:[e.jsx(l,{variant:"h6",component:"h3",className:"character-card-title",children:r.name}),e.jsx(l,{variant:"body2",color:"textSecondary",className:"character-card-description",children:r.description||"No description available"})]}),e.jsx(n,{className:"character-card-actions",children:e.jsxs(d,{sx:{display:"flex",justifyContent:"space-between",width:"100%"},children:[e.jsxs(d,{children:[e.jsx(m,{size:"small",onClick:()=>{u(t("view"))},title:"View Details",children:e.jsx(h,{})}),e.jsx(c,{title:"Edit",children:e.jsx(m,{size:"small",onClick:()=>{u(t("edit",r))},title:"Edit Character",children:e.jsx(p,{})})}),e.jsx(c,{title:"Delete",children:e.jsx(m,{size:"small",onClick:()=>{window.confirm("Are you sure you want to delete this character?")&&u(s(r.id))},title:"Delete Character",color:"error",children:e.jsx(j,{})})})]}),e.jsxs(l,{variant:"caption",color:"text.secondary",children:["Created: ",new Date(r.created_at).toLocaleDateString()]})]})})]})},{Option:A}=x,w=({universeId:a,characters:t,value:s,onChange:i,disabled:o=!1,onBlur:n,getPopupContainer:l=e=>e.parentNode})=>{const[c,d]=r.useState(Array.isArray(t)?t:[]),[m,h]=r.useState(!t),[p,j]=r.useState(!1);r.useEffect((()=>{if(t)return d(Array.isArray(t)?t:[]),void h(!1);(async()=>{var e;if(a)try{h(!0);const r=await u.getCharactersByUniverse(a);let t=[];if((null==(e=null==r?void 0:r.data)?void 0:e.characters)&&Array.isArray(r.data.characters))t=r.data.characters;else if(Array.isArray(null==r?void 0:r.data))t=r.data;else if(null==r?void 0:r.data){const e=Object.entries(r.data).filter((([e,r])=>Array.isArray(r))).sort((([e,r],[a,t])=>t.length-r.length));e.length>0&&(t=e[0][1])}d(Array.isArray(t)?t:[])}catch(r){const e=!window.location.hostname.includes("localhost");d(e?[{id:1001,name:"Demo Character 1"},{id:1002,name:"Demo Character 2"}]:[])}finally{h(!1)}})()}),[a,t]);return e.jsx(x,{mode:"multiple",style:{width:"100%"},placeholder:"Select characters in this scene",value:s,onChange:e=>{i&&i(e)},optionFilterProp:"children",loading:m,disabled:o,getPopupContainer:l,dropdownStyle:{zIndex:1100},listHeight:250,onDropdownVisibleChange:e=>{j(e),!e&&n&&"function"==typeof n&&setTimeout((()=>n()),100)},onBlur:()=>{n&&"function"==typeof n&&n()},open:p,autoComplete:"off",notFoundContent:m?e.jsx(y,{size:"small"}):e.jsx(f,{description:"No characters found"}),maxTagCount:5,maxTagTextLength:12,showArrow:!0,virtual:!0,children:Array.isArray(c)&&c.length>0?c.map((r=>e.jsx(A,{value:r.id,children:e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[r.avatar?e.jsx(v,{src:r.avatar,size:"small",style:{marginRight:8}}):e.jsx(v,{icon:e.jsx(g,{}),size:"small",style:{marginRight:8}}),r.name]})},r.id))):e.jsx(A,{disabled:!0,value:"no-characters",children:e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(v,{icon:e.jsx(g,{}),size:"small",style:{marginRight:8}}),"No characters available"]})})})};export{C,w as a};
