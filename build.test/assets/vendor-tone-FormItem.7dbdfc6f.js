import{t as e,_ as r}from"./vendor-tone-type.9e20d569.js";import{j as a,k as n,_ as t,l as o}from"./vendor-tone-esm.8edb30e2.js";import{b as i,L as s,W as l}from"./vendor-tone-es.9387ac1c.js";import{M as c,N as u,ai as d,aj as m,ak as f,al as p}from"./vendor-tone-util.a79eb63f.js";import{r as g,i as v,e as h}from"./vendor-react-core.73efc664.js";import{n as b,o as y,p as w,q as j}from"./vendor-tone-hooks.ee856eec.js";import"./vendor-tone-config-provider.2fc53c46.js";import{F as C,N as x,a as E,C as P}from"./vendor-tone-context.2287e470.js";import{n as S,o as k,p as q,d as I}from"./vendor-tone-icons.388eb8da.js";import{c as O}from"./vendor-tone-classnames.ea5eadd4.js";import{R as F}from"./vendor-tone-grid.9235ce83.js";import{a as _,b as M}from"./vendor-tone-form.6dd4e248.js";var N=globalThis&&globalThis.__rest||function(e,r){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var t=0;for(n=Object.getOwnPropertySymbols(e);t<n.length;t++)r.indexOf(n[t])<0&&Object.prototype.propertyIsEnumerable.call(e,n[t])&&(a[n[t]]=e[n[t]])}return a},T={success:S,warning:k,error:q,validating:I};function R(e){var r=e.prefixCls,o=e.className,i=e.style,s=e.help,l=e.errors,d=e.warnings,m=e.validateStatus,f=e.meta,p=e.hasFeedback,v=e.hidden,h=e.children,y=e.fieldId,w=e.isRequired,j=e.onSubItemMetaChange,P=N(e,["prefixCls","className","style","help","errors","warnings","validateStatus","meta","hasFeedback","hidden","children","fieldId","isRequired","onSubItemMetaChange"]),S="".concat(r,"-item"),k=g.useContext(C).requiredMark,q=g.useRef(null),I=b(l),R=b(d),V=null!=s,A=!!(V||l.length||d.length),B=g.useState(null),L=a(B,2),U=L[0],K=L[1];c((function(){if(A&&q.current){var e=getComputedStyle(q.current);K(parseInt(e.marginBottom,10))}}),[A]);var W="";void 0!==m?W=m:f.validating?W="validating":I.length?W="error":R.length?W="warning":f.touched&&(W="success");var z=g.useMemo((function(){var e;if(p){var r=W&&T[W];e=r?g.createElement("span",{className:O("".concat(S,"-feedback-icon"),"".concat(S,"-feedback-icon-").concat(W))},g.createElement(r,null)):null}return{status:W,hasFeedback:p,feedbackIcon:e,isFormItemInput:!0}}),[W,p]),G=n(n(n(n(n(n(n(n(n({},S,!0),"".concat(S,"-with-help"),V||I.length||R.length),"".concat(o),!!o),"".concat(S,"-has-feedback"),W&&p),"".concat(S,"-has-success"),"success"===W),"".concat(S,"-has-warning"),"warning"===W),"".concat(S,"-has-error"),"error"===W),"".concat(S,"-is-validating"),"validating"===W),"".concat(S,"-hidden"),v);return g.createElement("div",{className:O(G),style:i,ref:q},g.createElement(F,t({className:"".concat(S,"-row")},u(P,["_internalItemRender","colon","dependencies","extra","fieldKey","getValueFromEvent","getValueProps","htmlFor","id","initialValue","isListField","label","labelAlign","labelCol","labelWrap","messageVariables","name","normalize","noStyle","preserve","required","requiredMark","rules","shouldUpdate","trigger","tooltip","validateFirst","validateTrigger","valuePropName","wrapperCol"])),g.createElement(_,t({htmlFor:y,required:w,requiredMark:k},e,{prefixCls:r})),g.createElement(M,t({},e,f,{errors:I,warnings:R,prefixCls:r,status:W,help:s,marginBottom:U,onErrorVisibleChanged:function(e){e||K(null)}}),g.createElement(x.Provider,{value:j},g.createElement(E.Provider,{value:z},h)))),!!U&&g.createElement("div",{className:"".concat(S,"-margin-offset"),style:{marginBottom:-U}}))}e("success","warning","error","validating","");var V=g.memo((function(e){return e.children}),(function(e,r){return e.value===r.value&&e.update===r.update&&e.childProps.length===r.childProps.length&&e.childProps.every((function(e,a){return e===r.childProps[a]}))}));var A=function(e){var n=e.name,c=e.noStyle,u=e.dependencies,b=e.prefixCls,y=e.shouldUpdate,E=e.rules,S=e.children,k=e.required,q=e.label,I=e.messageVariables,O=e.trigger,F=void 0===O?"onChange":O,_=e.validateTrigger,M=e.hidden,N=g.useContext(P).getPrefixCls,T=g.useContext(C).name,A="function"==typeof S,B=g.useContext(x),L=g.useContext(i).validateTrigger,U=void 0!==_?_:L,K=function(e){return!(null==e)}(n),W=N("form",b),z=g.useContext(s),G=g.useRef(),D=w({}),H=a(D,2),J=H[0],Q=H[1],X=d((function(){return{errors:[],warnings:[],touched:!1,validating:!1,validated:!1,name:[]}})),Y=a(X,2),Z=Y[0],$=Y[1],ee=function(e,r){Q((function(a){var n=t({},a),i=[].concat(o(e.name.slice(0,-1)),o(r)).join("__SPLIT__");return e.destroy?delete n[i]:n[i]=e,n}))},re=g.useMemo((function(){var e=o(Z.errors),r=o(Z.warnings);return Object.values(J).forEach((function(a){e.push.apply(e,o(a.errors||[])),r.push.apply(r,o(a.warnings||[]))})),[e,r]}),[J,Z.errors,Z.warnings]),ae=a(re,2),ne=ae[0],te=ae[1],oe=j();function ie(r,a,n){return c&&!M?r:g.createElement(R,t({key:"row"},e,{prefixCls:W,fieldId:a,isRequired:n,errors:ne,warnings:te,meta:Z,onSubItemMetaChange:ee}),r)}if(!K&&!A&&!u)return ie(S);var se={};return"string"==typeof q?se.label=q:n&&(se.label=String(n)),I&&(se=t(t({},se),I)),g.createElement(l,t({},e,{messageVariables:se,trigger:F,validateTrigger:U,onMetaChange:function(e){var r=null==z?void 0:z.getKey(e.name);if($(e.destroy?{errors:[],warnings:[],touched:!1,validating:!1,validated:!1,name:[]}:e,!0),c&&B){var n=e.name;if(e.destroy)n=G.current||n;else if(void 0!==r){var t=a(r,2),i=t[0],s=t[1];n=[i].concat(o(s)),G.current=n}B(e,n)}}}),(function(a,i,s){var l=m(n).length&&i?i.name:[],c=f(l,T),d=void 0!==k?k:!(!E||!E.some((function(e){if(e&&"object"===r(e)&&e.required&&!e.warningOnly)return!0;if("function"==typeof e){var a=e(s);return a&&a.required&&!a.warningOnly}return!1}))),b=t({},a),w=null;if(Array.isArray(S)&&K)w=S;else if(A&&(!y&&!u||K));else if(!u||A||K)if(v(S)){var j=t(t({},S.props),b);if(j.id||(j.id=c),e.help||ne.length>0||te.length>0||e.extra){var C=[];(e.help||ne.length>0)&&C.push("".concat(c,"_help")),e.extra&&C.push("".concat(c,"_extra")),j["aria-describedby"]=C.join(" ")}ne.length>0&&(j["aria-invalid"]="true"),d&&(j["aria-required"]="true"),p(S)&&(j.ref=oe(l,S)),new Set([].concat(o(m(F)),o(m(U)))).forEach((function(e){j[e]=function(){for(var r,a,n,t,o,i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];null===(n=b[e])||void 0===n||(r=n).call.apply(r,[b].concat(s)),null===(o=(t=S.props)[e])||void 0===o||(a=o).call.apply(a,[t].concat(s))}}));var x=[j["aria-required"],j["aria-invalid"],j["aria-describedby"]];w=g.createElement(V,{value:b[e.valuePropName||"value"],update:S,childProps:x},h(S,j))}else w=A&&(y||u)&&!K?S(s):S;else;return ie(w,c,d)}))};A.useStatus=y;const B=A;export{B as I};
