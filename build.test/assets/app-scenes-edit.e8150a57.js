import{r as e,j as o}from"./vendor-react-core.73efc664.js";import{S as r}from"./app-scenes-form.07f7a30a.js";import t from"./app-services-api.399edcf9.js";import"./app-core.4fc76094.js";import{a as n,u as s}from"./vendor-react-router.6468192e.js";import{B as i}from"./vendor-tone-breadcrumb.30242f92.js";import{H as d,j as p,E as a,W as m}from"./vendor-tone-icons.388eb8da.js";import{A as v}from"./vendor-tone-alert.89362924.js";import{C as j}from"./vendor-tone-card.8385b307.js";import{S as c}from"./vendor-tone-spin.d13f75fd.js";import{T as l}from"./vendor-tone-typography.2404bb54.js";import{m as u}from"./vendor-tone-message.06244fbe.js";import"./vendor-tone-classnames.ea5eadd4.js";import"./vendor-mui-core.4359195f.js";import"./vendor-tone-useThemeProps.a5833127.js";import"./vendor-tone-util.a79eb63f.js";import"./vendor-tone-helpers.07e4d08d.js";import"./vendor-tone-platform.4f06f964.js";import"./vendor-tone-browser.dd42b0e8.js";import"./vendor-tone-classes.909fbaba.js";import"./vendor-tone-core-base.398f9a2a.js";import"./vendor-tone-defaults.617853c7.js";import"./vendor-tone-cancel.b93f499f.js";import"./vendor-tone-adapters.ec1cb8a7.js";import"./vendor-tone-lodash.1d9c6a83.js";import"./vendor-tone-events.9afa7530.js";import"./vendor-tone-audio.70450c41.js";import"./vendor-tone-source.0b4b1ccd.js";import"./vendor-tone-tslib.f5f62bcb.js";import"./vendor-tone-signal.648ab60f.js";import"./vendor-tone-components.680c7d7e.js";import"./vendor-tone-esm.8edb30e2.js";import"./vendor-tone-type.9e20d569.js";import"./vendor-tone-dist.6485732f.js";import"./vendor-tone-module.5bbe5778.js";import"./vendor-tone-styled-engine.72d9b7d5.js";import"./vendor-emotion-styled.ae0fdb08.js";import"./vendor-emotion-core.fcf170e6.js";import"./vendor-tone-src.89c6b4f5.js";import"./vendor-tone-StyledEngineProvider.626b917c.js";import"./vendor-tone-GlobalStyles.58bf1e29.js";import"./vendor-tone-createTheme.6c673f08.js";import"./vendor-tone-styleFunctionSx.dbcb4226.js";import"./vendor-tone-instruments.3eb491c0.js";import"./vendor-tone-effects.66f8dc4e.js";import"./vendor-react-dom.e7130502.js";import"./vendor-react-scheduler.c51d43b5.js";import"./vendor-tone-hooks.ee856eec.js";import"./vendor-tone-es.9387ac1c.js";import"./vendor-tone-dist-web.442e5e08.js";import"./vendor-tone-Selector.7ca3b0ed.js";import"./vendor-tone-TimePanel.ca272323.js";import"./vendor-tone-panels.35d19878.js";import"./vendor-tone-DatetimePanel.eb5b0baf.js";import"./vendor-tone-DatePanel.9f66ebd0.js";import"./vendor-tone-WeekPanel.896778be.js";import"./vendor-tone-MonthPanel.70b7688e.js";import"./vendor-tone-QuarterPanel.144363f0.js";import"./vendor-tone-YearPanel.b92617d1.js";import"./vendor-tone-DecadePanel.8c0dc02f.js";import"./vendor-tone-TabPanelList.10481429.js";import"./vendor-tone-TabNavList.2513addc.js";import"./vendor-tone-Dialog.2ffc21c8.js";import"./vendor-tone-Content.9808c346.js";import"./vendor-tone-context.2287e470.js";import"./vendor-tone-SubMenu.1b0c3984.js";import"./vendor-tone-Popup.9ff27a32.js";import"./vendor-tone-SingleObserver.ddf11abe.js";import"./vendor-tone-config-provider.2fc53c46.js";import"./vendor-tone-form.6dd4e248.js";import"./vendor-tone-grid.9235ce83.js";import"./vendor-tone-locale-provider.8d53e5b8.js";import"./vendor-tone-modal.4772d80b.js";import"./vendor-tone-button.429dcaea.js";import"./vendor-tone-space.95ee87ca.js";import"./vendor-tone-locale.9bc1cdd3.js";import"./vendor-tone-useModal.b905cda5.js";import"./vendor-tone-tooltip.4e7d946d.js";import"./vendor-tone-FormItem.7dbdfc6f.js";import"./vendor-tone-notification.2961f1bd.js";import"./vendor-tone-empty.6f888680.js";import"./vendor-tone-channel.a150b5c9.js";import"./vendor-tone-menu.86d2dba0.js";import"./vendor-tone-layout.4cbd4c32.js";import"./vendor-tone-useMediaQuery.95247262.js";import"./vendor-mui-buttons.74e6c144.js";import"./vendor-tone-system.c96386b3.js";import"./vendor-mui-inputs.b77362ac.js";import"./vendor-tone-validation.226ee14c.js";import"./vendor-tone-LocalizationProvider.b505657c.js";import"./vendor-tone-locales.e8ab67da.js";import"./vendor-tone-RtlProvider.df0b182e.js";import"./vendor-tone-constants.d67dcaf6.js";import"./vendor-mui-dialogs.59185291.js";import"./vendor-tone-env.26551821.js";import"./vendor-react-props.65efe0a6.js";import"./vendor-mui-list.1c6188a6.js";import"./vendor-tone-Stack.f8b60d0c.js";import"./vendor-mui-menus.328affd2.js";import"./vendor-tone-DefaultPropsProvider.3d25d93b.js";import"./vendor-react-redux.ca23f922.js";import"./vendor-tone-shim.e999ecad.js";import"./vendor-tone-cjs.5d603e0b.js";import"./vendor-tone-use-sync-external-store-shim.d3746bbc.js";import"./app-redux-character-slice.77cb9e4b.js";import"./vendor-redux-toolkit.fa18e013.js";import"./vendor-redux-core.f9606c35.js";import"./app-redux-character-thunks.c46623e8.js";import"./app-utils.cd93f9c5.js";import"./vendor-tone-lib.58935e90.js";import"./app-constants.4a812be2.js";import"./app-modals.11788519.js";import"./app-other-components.5e297c7e.js";import"./app-redux-scene-thunks.d96f7130.js";import"./app-redux-scene-slice.81f21730.js";import"./app-contexts.6347d155.js";import"./app-redux-other-slices.a7022ed8.js";import"./app-redux-auth-thunks.3612091e.js";import"./app-redux-auth-slice.749a10ad.js";import"./app-redux-note-slice.2ed79aa2.js";import"./app-redux-note-thunks.e47bcfeb.js";import"./vendor-mui-card.3348f8fd.js";import"./vendor-mui-layout.b03fb29f.js";import"./vendor-tone-Container.5ed3ed7d.js";import"./vendor-mui-icons-other.bc15c9b6.js";import"./app-characters-components.a508a592.js";import"./vendor-tone-select.c6c7620f.js";import"./vendor-tone-avatar.122bfb6a.js";import"./vendor-tone-popover.9c9808a5.js";import"./app-redux-physics-thunks.c58b7b1a.js";import"./vendor-tone-upload.27f9a3b5.js";import"./vendor-tone-UploadList.9372bedd.js";import"./vendor-tone-progress.cc741b51.js";import"./vendor-tone-switch.4218e0a6.js";import"./app-scenes-components.e3ba29e5.js";import"./app-services-other.47edd63d.js";import"./app-physics-components.dcafff4c.js";import"./app-physics-list.9dc0d346.js";import"./app-redux-physics-slice.b0d37703.js";import"./vendor-tone-asn.f94d41fd.js";import"./app-redux-core.93965072.js";import"./vendor-redux-persist.1ece7284.js";import"./app-routes.fd68d670.js";import"./vendor-tone-dayjs.54e2289e.js";import"./vendor-tone-skeleton.45affeec.js";import"./vendor-tone-tabs.69cd71fe.js";import"./vendor-tone-input.876080ec.js";import"./vendor-tone-divider.a6c32c3c.js";import"./vendor-tone-date-picker.3f71bbe3.js";import"./vendor-tone-tag.30f4ea2f.js";import"./vendor-tone-generate.3bd3dbc2.js";import"./vendor-tone-generatePicker.e957b148.js";import"./vendor-tone-radio.0de19148.js";import"./vendor-tone-Base.81f829aa.js";import"./vendor-tone-copy-to-clipboard.e7f533f2.js";import"./vendor-tone-toggle-selection.c563a038.js";import"./vendor-tone-DatePicker.de25fe8c.js";import"./vendor-tone-DesktopDatePicker.f7be1484.js";import"./vendor-tone-dateViewRenderers.da97565f.js";import"./vendor-tone-DateCalendar.07d8b1f1.js";import"./vendor-tone-PickersDay.36f5e5b8.js";import"./vendor-tone-PickersCalendarHeader.d19a4873.js";import"./vendor-tone-YearCalendar.53b1f79c.js";import"./vendor-tone-MonthCalendar.110ab177.js";import"./vendor-tone-DateField.a7ba308d.js";import"./vendor-tone-useField.40869926.js";import"./vendor-tone-PickersTextField.1b1b2159.js";import"./vendor-tone-PickersInput.177ec5f5.js";import"./vendor-tone-PickersInputBase.b4cbf25e.js";import"./vendor-tone-PickersSectionList.b3696c3f.js";import"./vendor-tone-PickersFilledInput.ea55e758.js";import"./vendor-tone-PickersOutlinedInput.cd7d73be.js";import"./vendor-tone-useDesktopPicker.83b3e221.js";import"./vendor-tone-usePicker.425377a1.js";import"./vendor-tone-PickersLayout.80c91798.js";import"./vendor-tone-PickersActionBar.6bdc4ff9.js";import"./vendor-tone-PickersShortcuts.51e2ec2a.js";import"./vendor-tone-MobileDatePicker.51f93f0c.js";import"./vendor-tone-useMobilePicker.b0b52352.js";import"./vendor-tone-input-number.28372503.js";import"./vendor-tone-dropdown.7b4c4d10.js";const{Title:h}=l,x=()=>{const{universeId:l,sceneId:x}=n(),y=s(),[P,f]=e.useState(!0),[g,k]=e.useState(null),[b,S]=e.useState(""),[D,I]=e.useState(null);e.useEffect((()=>{x?(async()=>{var e,o,r;try{f(!0),I(null);const s=await t.getScene(x),i=(null==(e=s.data)?void 0:e.scene)||s.data;if(k(i),null==(o=null==i?void 0:i.universe)?void 0:o.name)S(i.universe.name);else if(l)try{const e=await t.getUniverse(l),o=(null==(r=e.data)?void 0:r.universe)||e.data;(null==o?void 0:o.name)&&S(o.name)}catch(n){}}catch(n){I("Failed to load scene data. Please refresh the page and try again."),u.error("Failed to load scene. Please try again.")}finally{f(!1)}})():(f(!1),I("No scene ID provided. Cannot edit without a scene ID."))}),[x,l]);return o.jsxs("div",{className:"scene-edit-page",children:[o.jsxs(i,{className:"scene-breadcrumbs",children:[o.jsxs(i.Item,{href:"/",children:[o.jsx(d,{})," Home"]}),g&&o.jsxs(o.Fragment,{children:[o.jsx(i.Item,{href:`/universes/${g.universe_id||l}`,children:b||`Universe ${g.universe_id||l}`}),o.jsxs(i.Item,{href:`/universes/${g.universe_id||l}/scenes/${x}`,children:[o.jsx(p,{})," ",g.name||"Scene Details"]})]}),!g&&l&&o.jsxs(o.Fragment,{children:[o.jsx(i.Item,{href:`/universes/${l}`,children:b||`Universe ${l}`}),o.jsxs(i.Item,{href:`/universes/${l}/scenes/${x}`,children:[o.jsx(p,{})," ","Scene Details"]})]}),o.jsxs(i.Item,{children:[o.jsx(a,{})," Edit Scene"]})]}),o.jsx("div",{className:"scene-edit-header",children:o.jsx(h,{level:2,children:(null==g?void 0:g.name)?`Edit "${g.name}"`:"Edit Scene"})}),D&&o.jsx(v,{message:"Error",description:D,type:"error",showIcon:!0,icon:o.jsx(m,{}),style:{marginBottom:"24px"},closable:!0}),P&&!g?o.jsx(j,{className:"loading-card",children:o.jsxs("div",{className:"loading-container",children:[o.jsx(c,{size:"large"}),o.jsx("p",{children:"Loading scene data..."})]})}):g?o.jsx(r,{universeId:l||g.universe_id,sceneId:x,initialData:g,onSubmit:e=>(async e=>{var o,r,n;try{f(!0),I(null);const r=l||g&&g.universe_id;!e.universe_id&&r&&(e.universe_id=r);const n=await t.updateScene(x,e);let s;s=(null==(o=n.data)?void 0:o.scene)?n.data.scene:n.data?n.data:n,u.success("Scene updated successfully!");const i=s.universe_id||r||s.universe&&s.universe.id;return setTimeout((()=>{y(i?`/universes/${i}/scenes/${x}`:"/dashboard")}),500),s}catch(s){throw I(`Failed to update scene: ${(null==(n=null==(r=s.response)?void 0:r.data)?void 0:n.error)||s.message||"An unknown error occurred"}`),u.error("Failed to update scene. Please try again."),s}finally{f(!1)}})(e),onCancel:()=>{(()=>{const e=l||g&&g.universe_id;y(e?`/universes/${e}/scenes/${x}`:"/dashboard")})()}}):!P&&o.jsx(j,{className:"error-card",children:o.jsxs("div",{className:"error-container",children:[o.jsx("p",{children:"Scene not found. The scene may have been deleted or you don't have permission to view it."}),o.jsx("button",{onClick:()=>y(`/universes/${l}`),children:"Return to Universe"})]})})]})};export{x as default};
