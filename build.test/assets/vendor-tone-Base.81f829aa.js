import{j as e,_ as t,k as n}from"./vendor-tone-esm.8edb30e2.js";import{_ as o}from"./vendor-tone-type.9e20d569.js";import{E as r,e as i,l}from"./vendor-tone-icons.388eb8da.js";import{c as a}from"./vendor-tone-classnames.ea5eadd4.js";import{c as s}from"./vendor-tone-copy-to-clipboard.e7f533f2.js";import{R as c}from"./vendor-tone-es.9387ac1c.js";import{L as u,M as f,N as d,O as p,P as v,Q as m,R as y}from"./vendor-tone-util.a79eb63f.js";import{r as g}from"./vendor-react-core.73efc664.js";import"./vendor-tone-config-provider.2fc53c46.js";import{u as b}from"./vendor-tone-locale-provider.8d53e5b8.js";import{T as h}from"./vendor-tone-tooltip.4e7d946d.js";import{E,O as x}from"./vendor-tone-typography.2404bb54.js";import{u as S,a as w}from"./vendor-tone-hooks.ee856eec.js";import{C as k}from"./vendor-tone-context.2287e470.js";function j(e){var t=o(e);return"string"===t||"number"===t}function C(e,t){for(var n=0,o=[],r=0;r<e.length;r+=1){if(n===t)return o;var i=e[r],l=n+(j(i)?String(i).length:1);if(l>t){var a=t-n;return o.push(String(i).slice(0,a)),o}o.push(i),n=l}return e}const O=function(n){var o=n.enabledMeasure,r=n.children,i=n.text,l=n.width,a=n.fontSize,s=n.rows,c=n.onEllipsis,d=g.useState([0,0,0]),p=e(d,2),v=e(p[0],3),m=v[0],y=v[1],b=v[2],h=p[1],E=g.useState(0),x=e(E,2),S=x[0],w=x[1],k=g.useState(0),O=e(k,2),M=O[0],P=O[1],R=g.useRef(null),z=g.useRef(null),N=g.useMemo((function(){return u(i)}),[i]),T=g.useMemo((function(){return function(e){var t=0;return e.forEach((function(e){j(e)?t+=String(e).length:t+=1})),t}(N)}),[N]),I=g.useMemo((function(){return o&&3===S?r(C(N,y),y<T):r(N,!1)}),[o,S,r,N,y,T]);f((function(){o&&l&&a&&T&&(w(1),h([0,Math.ceil(T/2),T]))}),[o,l,a,i,T,s]),f((function(){var e;1===S&&P((null===(e=R.current)||void 0===e?void 0:e.offsetHeight)||0)}),[S]),f((function(){var e,t;if(M)if(1===S)((null===(e=z.current)||void 0===e?void 0:e.offsetHeight)||0)<=s*M?(w(4),c(!1)):w(2);else if(2===S)if(m!==b){var n=(null===(t=z.current)||void 0===t?void 0:t.offsetHeight)||0,o=m,r=b;m===b-1?r=m:n<=s*M?o=y:r=y;var i=Math.ceil((o+r)/2);h([o,i,r])}else w(3),c(!0)}),[S,m,b,s,M]);var H,L,F={width:l,whiteSpace:"normal",margin:0,padding:0},W=function(e,n,o){return g.createElement("span",{"aria-hidden":!0,ref:n,style:t({position:"fixed",display:"block",left:0,top:0,zIndex:-9999,visibility:"hidden",pointerEvents:"none",fontSize:2*Math.floor(a/2)},o)},e)};return g.createElement(g.Fragment,null,I,o&&3!==S&&4!==S&&g.createElement(g.Fragment,null,W("lg",R,{wordBreak:"keep-all",whiteSpace:"nowrap"}),1===S?W(r(N,!1),z,F):(H=z,L=C(N,y),W(r(L,!0),H,F))))};const M=function(e){var n=e.enabledEllipsis,o=e.isEllipsis,r=e.children,i=e.tooltipProps;return(null==i?void 0:i.title)&&n?g.createElement(h,t({open:!!o&&void 0},i),r):r};var P=globalThis&&globalThis.__rest||function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n};function R(e,t,n){return!0===e||void 0===e?t:e||n&&t}function z(e){return!1===e?[!1,!1]:Array.isArray(e)?e:[e]}const N=g.forwardRef((function(j,C){var N,T,I,H=j.prefixCls,L=j.className,F=j.style,W=j.type,_=j.disabled,A=j.children,B=j.ellipsis,D=j.editable,G=j.copyable,Q=j.component,U=j.title,V=P(j,["prefixCls","className","style","type","disabled","children","ellipsis","editable","copyable","component","title"]),q=g.useContext(k),J=q.getPrefixCls,K=q.direction,X=b("Text")[0],Y=g.useRef(null),Z=g.useRef(null),$=J("typography",H),ee=d(V,["mark","code","delete","underline","strong","keyboard","italic"]),te=S(D),ne=e(te,2),oe=ne[0],re=ne[1],ie=p(!1,{value:re.editing}),le=e(ie,2),ae=le[0],se=le[1],ce=re.triggerType,ue=void 0===ce?["icon"]:ce,fe=function(e){var t;e&&(null===(t=re.onStart)||void 0===t||t.call(re)),se(e)};w((function(){var e;ae||null===(e=Z.current)||void 0===e||e.focus()}),[ae]);var de=function(e){null==e||e.preventDefault(),fe(!0)},pe=S(G),ve=e(pe,2),me=ve[0],ye=ve[1],ge=g.useState(!1),be=e(ge,2),he=be[0],Ee=be[1],xe=g.useRef(),Se={};ye.format&&(Se.format=ye.format);var we=function(){window.clearTimeout(xe.current)},ke=function(e){var t;null==e||e.preventDefault(),null==e||e.stopPropagation(),s(ye.text||String(A)||"",Se),Ee(!0),we(),xe.current=window.setTimeout((function(){Ee(!1)}),3e3),null===(t=ye.onCopy)||void 0===t||t.call(ye,e)};g.useEffect((function(){return we}),[]);var je=g.useState(!1),Ce=e(je,2),Oe=Ce[0],Me=Ce[1],Pe=g.useState(!1),Re=e(Pe,2),ze=Re[0],Ne=Re[1],Te=g.useState(!1),Ie=e(Te,2),He=Ie[0],Le=Ie[1],Fe=g.useState(!1),We=e(Fe,2),_e=We[0],Ae=We[1],Be=g.useState(!1),De=e(Be,2),Ge=De[0],Qe=De[1],Ue=g.useState(!0),Ve=e(Ue,2),qe=Ve[0],Je=Ve[1],Ke=S(B,{expandable:!1}),Xe=e(Ke,2),Ye=Xe[0],Ze=Xe[1],$e=Ye&&!He,et=Ze.rows,tt=void 0===et?1:et,nt=g.useMemo((function(){return!$e||void 0!==Ze.suffix||Ze.onEllipsis||Ze.expandable||oe||me}),[$e,Ze,oe,me]);f((function(){Ye&&!nt&&(Me(v("webkitLineClamp")),Ne(v("textOverflow")))}),[nt,Ye]);var ot=g.useMemo((function(){return!nt&&(1===tt?ze:Oe)}),[nt,ze,Oe]),rt=$e&&(ot?Ge:_e),it=$e&&1===tt&&ot,lt=$e&&tt>1&&ot,at=function(e){var t;Le(!0),null===(t=Ze.onExpand)||void 0===t||t.call(Ze,e)},st=g.useState(0),ct=e(st,2),ut=ct[0],ft=ct[1],dt=g.useState(0),pt=e(dt,2),vt=pt[0],mt=pt[1],yt=function(e){var t;Ae(e),_e!==e&&(null===(t=Ze.onEllipsis)||void 0===t||t.call(Ze,e))};g.useEffect((function(){var e=Y.current;if(Ye&&ot&&e){var t=lt?e.offsetHeight<e.scrollHeight:e.offsetWidth<e.scrollWidth;Ge!==t&&Qe(t)}}),[Ye,ot,A,lt,qe]),g.useEffect((function(){var e=Y.current;if("undefined"!=typeof IntersectionObserver&&e&&ot&&$e){var t=new IntersectionObserver((function(){Je(!!e.offsetParent)}));return t.observe(e),function(){t.disconnect()}}}),[ot,$e]);var gt={};gt=!0===Ze.tooltip?{title:null!==(N=re.text)&&void 0!==N?N:A}:g.isValidElement(Ze.tooltip)?{title:Ze.tooltip}:"object"===o(Ze.tooltip)?t({title:null!==(T=re.text)&&void 0!==T?T:A},Ze.tooltip):{title:Ze.tooltip};var bt=g.useMemo((function(){var e=function(e){return["string","number"].includes(o(e))};if(Ye&&!ot)return e(re.text)?re.text:e(A)?A:e(U)?U:e(gt.title)?gt.title:void 0}),[Ye,ot,U,gt.title,rt]);if(ae)return g.createElement(E,{value:null!==(I=re.text)&&void 0!==I?I:"string"==typeof A?A:"",onSave:function(e){var t;null===(t=re.onChange)||void 0===t||t.call(re,e),fe(!1)},onCancel:function(){var e;null===(e=re.onCancel)||void 0===e||e.call(re),fe(!1)},onEnd:re.onEnd,prefixCls:$,className:L,style:F,direction:K,component:Q,maxLength:re.maxLength,autoSize:re.autoSize,enterIcon:re.enterIcon});var ht=function(){if(oe){var e=re.icon,t=re.tooltip,n=u(t)[0]||X.edit,o="string"==typeof n?n:"";return ue.includes("icon")?g.createElement(h,{key:"edit",title:!1===t?"":n},g.createElement(y,{ref:Z,className:"".concat($,"-edit"),onClick:de,"aria-label":o},e||g.createElement(r,{role:"button"}))):null}},Et=function(){if(me){var e=ye.tooltips,t=ye.icon,n=z(e),o=z(t),r=he?R(n[1],X.copied):R(n[0],X.copy),s=he?X.copied:X.copy,c="string"==typeof r?r:s;return g.createElement(h,{key:"copy",title:r},g.createElement(y,{className:a("".concat($,"-copy"),he&&"".concat($,"-copy-success")),onClick:ke,"aria-label":c},he?R(o[1],g.createElement(i,null),!0):R(o[0],g.createElement(l,null),!0)))}};return g.createElement(c,{onResize:function(e,t){var n,o=e.offsetWidth;ft(o),mt(parseInt(null===(n=window.getComputedStyle)||void 0===n?void 0:n.call(window,t).fontSize,10)||0)},disabled:!$e||ot},(function(e){return g.createElement(M,{tooltipProps:gt,enabledEllipsis:$e,isEllipsis:rt},g.createElement(x,t({className:a(n(n(n(n(n(n({},"".concat($,"-").concat(W),W),"".concat($,"-disabled"),_),"".concat($,"-ellipsis"),Ye),"".concat($,"-single-line"),$e&&1===tt),"".concat($,"-ellipsis-single-line"),it),"".concat($,"-ellipsis-multiple-line"),lt),L),prefixCls:H,style:t(t({},F),{WebkitLineClamp:lt?tt:void 0}),component:Q,ref:m(e,Y,C),direction:K,onClick:ue.includes("text")?de:void 0,"aria-label":null==bt?void 0:bt.toString(),title:U},ee),g.createElement(O,{enabledMeasure:$e&&!ot,text:A,rows:tt,width:ut,fontSize:vt,onEllipsis:yt},(function(e,t){var n=e;e.length&&t&&bt&&(n=g.createElement("span",{key:"show-content","aria-hidden":!0},n));var o=function(e,t){var n=e.mark,o=e.code,r=e.underline,i=e.delete,l=e.strong,a=e.keyboard,s=e.italic,c=t;function u(e,t){e&&(c=g.createElement(t,{},c))}return u(l,"strong"),u(r,"u"),u(i,"del"),u(o,"code"),u(n,"mark"),u(a,"kbd"),u(s,"i"),c}(j,g.createElement(g.Fragment,null,n,function(e){return[e&&g.createElement("span",{"aria-hidden":!0,key:"ellipsis"},"..."),Ze.suffix,(t=e,[t&&(o=Ze.expandable,r=Ze.symbol,o?(n=r||X.expand,g.createElement("a",{key:"expand",className:"".concat($,"-expand"),onClick:at,"aria-label":X.expand},n)):null),ht(),Et()])];var t,n,o,r}(t)));return o}))))}))}));export{N as B};
