import{j as e,r as t}from"./vendor-react-core.73efc664.js";import{M as o}from"./app-other-components.5e297c7e.js";import"./app-core.4fc76094.js";import{a as n}from"./vendor-react-redux.ca23f922.js";import"./app-redux-scene-thunks.d96f7130.js";import{u as s,M as r}from"./app-contexts.6347d155.js";import{a as l,c as a}from"./app-redux-other-slices.a7022ed8.js";import{M as i,m as c}from"./app-utils.cd93f9c5.js";import{P as d}from"./vendor-react-props.65efe0a6.js";import{r as u}from"./vendor-react-dom.e7130502.js";const m=({title:t,message:n,confirmText:s="OK",onConfirm:r,onClose:l,...a})=>e.jsx(o,{type:"alert",title:t,onClose:l,size:i.SIZES.SMALL,animation:i.ANIMATIONS.FADE,...a,children:e.jsxs("div",{className:"modal-content",children:[e.jsx("p",{children:n}),e.jsx("div",{className:"modal-actions",children:e.jsx("button",{onClick:r||l,children:s})})]})});m.propTypes={title:d.string.isRequired,message:d.string.isRequired,confirmText:d.string,onConfirm:d.func,onClose:d.func.isRequired};const p=({title:t,message:s,confirmText:r="Yes",cancelText:a="No",confirmId:i,cancelId:c,onClose:d,...u})=>{const m=n(l);return e.jsx(o,{isOpen:m,type:"confirm",title:t,onClose:d,...u,children:e.jsxs("div",{className:"modal-content",children:[e.jsx("p",{children:s}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{onClick:()=>{if(c){const e=new CustomEvent("modal-cancel",{detail:{action:c}});document.dispatchEvent(e)}d()},className:"modal-button modal-button-secondary",children:a}),e.jsx("button",{onClick:()=>{if(i){const e=new CustomEvent("modal-confirm",{detail:{action:i}});document.dispatchEvent(e)}d()},className:"modal-button modal-button-primary",children:r})]})]})})};p.propTypes={title:d.string.isRequired,message:d.string.isRequired,confirmText:d.string,cancelText:d.string,confirmId:d.string,cancelId:d.string,onClose:d.func.isRequired};const f=({title:t,children:n,onSubmit:s,onCancel:r,onClose:l,...a})=>e.jsx(o,{type:"form",title:t,onClose:l,...a,children:e.jsx("div",{className:"modal-content",children:n})});f.propTypes={title:d.string.isRequired,children:d.node.isRequired,onSubmit:d.func,onCancel:d.func,onClose:d.func.isRequired};const b=()=>{const o=n(a),{close:r}=s();if(t.useEffect((()=>{}),[o]),!o)return null;if(o.type){const t=c.getModalComponent(o.type);if(t)return e.jsx(t,{...o,onClose:r})}return null},y=({children:t})=>e.jsxs(r,{children:[t,e.jsx(b,{})]});y.propTypes={children:d.node.isRequired},i.ANIMATIONS.FADE.duration;let x=0,v=0;const g=t.forwardRef((({isOpen:o,onClose:n,title:s="Modal",children:r,size:l=i.SIZES.MEDIUM,type:a=i.TYPES.DEFAULT,animation:c=i.ANIMATIONS.FADE,position:d=i.POSITIONS.CENTER,showCloseButton:m=i.DEFAULT_SETTINGS.showCloseButton,preventBackdropClick:p=!1,className:f="",footerContent:b=null,ariaDescribedBy:y="",initialFocusRef:g=null,preventAutoClose:h=!1,draggable:S=i.DEFAULT_SETTINGS.draggable,closeOnEscape:C=i.DEFAULT_SETTINGS.closeOnEscape,closeOnBackdrop:E=i.DEFAULT_SETTINGS.closeOnBackdrop,preventBodyScroll:T=i.DEFAULT_SETTINGS.preventBodyScroll,"data-modal-id":j,"data-modal-type":N},R)=>{const I=t.useRef(null),A=t.useRef(null),O=t.useRef(null),[q,k]=t.useState(!1),[w,D]=t.useState(0),[M,B]=t.useState(!1),[L,$]=t.useState({x:0,y:0}),[F,U]=t.useState({x:0,y:0}),Y=document.getElementById("portal-root")||document.body,P=t.useRef(`modal-${Math.random().toString(36).substr(2,9)}`),G=`${P.current}-title`,_=`${P.current}-content`,z=t.useRef(!1),Z=t.useRef(Date.now()),X=t.useRef(null);t.useEffect((()=>{const e=document.createElement("div");return e.classList.add("modal-portal"),X.current=e,()=>{var e;(null==(e=X.current)?void 0:e.parentElement)&&X.current.parentElement.removeChild(X.current)}}),[]);const K=R||I,W=t.useCallback((e=>{if(S&&e.target.closest(".modal-header")){if(B(!0),I.current){const t=I.current.getBoundingClientRect();U({x:e.clientX-t.left-L.x,y:e.clientY-t.top-L.y})}e.preventDefault()}}),[S,L]);t.useCallback((e=>{M&&$({x:e.clientX-F.x,y:e.clientY-F.y})}),[M,F]),t.useCallback((()=>{B(!1)}),[]);const H=t.useCallback((()=>{q||(k(!0),n())}),[q,n]);if(t.useEffect((()=>{const e=e=>{"Escape"===e.key&&o&&!q&&C&&H()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)}),[o,q,H,C]),t.useEffect((()=>{var e,t,n,s;if(o){z.current=!0,Z.current=Date.now(),null==(e=I.current)||e.setAttribute("data-opened-at",Z.current.toString()),null==(t=I.current)||t.setAttribute("data-prevent-close","false"),N&&(null==(n=I.current)||n.setAttribute("data-modal-type",N)),j&&(null==(s=I.current)||s.setAttribute("data-modal-id",j));const o=setTimeout((()=>{I.current&&I.current.setAttribute("data-prevent-close","false")}),500);return O.current=document.activeElement,x++,D(x),1===x&&(v=window.scrollY,document.body.classList.add("modal-open"),document.body.style.position="fixed",document.body.style.top=`-${v}px`,document.body.style.width="100%",document.body.style.overflow="hidden"),requestAnimationFrame((()=>{if(null==g?void 0:g.current)g.current.focus();else if(I.current){const e=I.current.querySelector('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');e?e.focus():I.current.focus()}})),()=>{clearTimeout(o)}}k(!1),z.current=!1,x--,0===x&&(document.body.classList.remove("modal-open"),document.body.style.position="",document.body.style.top="",document.body.style.width="",document.body.style.overflow="",window.scrollTo(0,v))}),[o,g,N,j]),!o)return null;const J=e.jsxs("div",{ref:K,id:P.current,role:"dialog","aria-modal":"true","aria-labelledby":G,"aria-describedby":y||_,className:"modal-overlay "+(q?"closing":""),style:{zIndex:1e3+w},tabIndex:"-1","data-testid":"modal","data-mounted-at":Date.now().toString(),children:[e.jsx("div",{className:"modal-backdrop",onClick:p||!E?void 0:H,"data-testid":"modal-backdrop"}),e.jsxs("div",{className:`modal-content modal-${l} modal-${a} modal-${d} ${c!==i.ANIMATIONS.NONE?`modal-animation-${c}`:""} ${q?"closing":""} ${M?"dragging":""} ${f||""}`,ref:A,style:{transform:S?`translate(${L.x}px, ${L.y}px)`:void 0},children:[e.jsxs("div",{className:"modal-header",onMouseDown:S?W:void 0,children:[e.jsx("h2",{id:G,className:"modal-title",children:s}),m&&e.jsx("button",{type:"button",className:"modal-close","aria-label":"Close",onClick:H,"data-testid":"modal-close-button",children:"Ã—"})]}),e.jsx("div",{id:_,className:"modal-body",children:r}),b&&e.jsx("div",{className:"modal-footer",children:b})]})]});return X.current?u.createPortal(J,Y):null}));g.propTypes={isOpen:d.bool.isRequired,onClose:d.func.isRequired,title:d.string,children:d.node,size:d.oneOf(Object.values(i.SIZES)),type:d.oneOf(Object.values(i.TYPES)),animation:d.oneOf(Object.values(i.ANIMATIONS)),position:d.oneOf(Object.values(i.POSITIONS)),showCloseButton:d.bool,preventBackdropClick:d.bool,className:d.string,footerContent:d.node,ariaDescribedBy:d.string,initialFocusRef:d.object,preventAutoClose:d.bool,draggable:d.bool,closeOnEscape:d.bool,closeOnBackdrop:d.bool,preventBodyScroll:d.bool,"data-modal-id":d.string,"data-modal-type":d.string},g.displayName="ModalSystem",d.node.isRequired,d.bool.isRequired,d.func.isRequired,d.string.isRequired,d.string,d.string,d.func,d.func.isRequired;d.string.isRequired,d.node.isRequired,d.func,d.number,d.string,d.oneOfType([d.string,d.number]).isRequired,d.string,d.func,d.func.isRequired,d.bool;export{m as A,p as C,f as F,y as M,g as a};
