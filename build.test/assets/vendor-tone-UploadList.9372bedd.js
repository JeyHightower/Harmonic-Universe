import{j as e,k as n,_ as t,l as o}from"./vendor-tone-esm.8edb30e2.js";import{f as r,D as i,r as a,s as l,F as c,d as s,t as m}from"./vendor-tone-icons.388eb8da.js";import{c as u}from"./vendor-tone-classnames.ea5eadd4.js";import{C as d,h as p}from"./vendor-tone-es.9387ac1c.js";import{r as f,e as v,i as w}from"./vendor-react-core.73efc664.js";import{B as E}from"./vendor-tone-button.429dcaea.js";import"./vendor-tone-config-provider.2fc53c46.js";import{aJ as g,aK as y,aL as h,aM as b}from"./vendor-tone-util.a79eb63f.js";import{P as N}from"./vendor-tone-progress.cc741b51.js";import{T as I}from"./vendor-tone-tooltip.4e7d946d.js";import{C as k}from"./vendor-tone-context.2287e470.js";const C=f.forwardRef((function(o,l){var c,s,m=o.prefixCls,p=o.className,v=o.style,w=o.locale,E=o.listType,g=o.file,y=o.items,h=o.progress,b=o.iconRender,C=o.actionIconRender,j=o.itemRender,R=o.isImgUrl,P=o.showPreviewIcon,x=o.showRemoveIcon,U=o.showDownloadIcon,F=o.previewIcon,D=o.removeIcon,T=o.downloadIcon,O=o.onPreview,A=o.onDownload,S=o.onClose,_=g.status,B=f.useState(_),J=e(B,2),L=J[0],z=J[1];f.useEffect((function(){"removed"!==_&&z(_)}),[_]);var H=f.useState(!1),K=e(H,2),M=K[0],V=K[1],W=f.useRef(null);f.useEffect((function(){return W.current=setTimeout((function(){V(!0)}),300),function(){W.current&&clearTimeout(W.current)}}),[]);var q="".concat(m,"-span"),G=b(g),Q=f.createElement("div",{className:"".concat(m,"-text-icon")},G);if("picture"===E||"picture-card"===E)if("uploading"===L||!g.thumbUrl&&!g.url){var X=u(n(n({},"".concat(m,"-list-item-thumbnail"),!0),"".concat(m,"-list-item-file"),"uploading"!==L));Q=f.createElement("div",{className:X},G)}else{var Y=(null==R?void 0:R(g))?f.createElement("img",{src:g.thumbUrl||g.url,alt:g.name,className:"".concat(m,"-list-item-image"),crossOrigin:g.crossOrigin}):G,Z=u(n(n({},"".concat(m,"-list-item-thumbnail"),!0),"".concat(m,"-list-item-file"),R&&!R(g)));Q=f.createElement("a",{className:Z,onClick:function(e){return O(g,e)},href:g.url||g.thumbUrl,target:"_blank",rel:"noopener noreferrer"},Y)}var $,ee=u(n(n(n({},"".concat(m,"-list-item"),!0),"".concat(m,"-list-item-").concat(L),!0),"".concat(m,"-list-item-list-type-").concat(E),!0)),ne="string"==typeof g.linkProps?JSON.parse(g.linkProps):g.linkProps,te=x?C(("function"==typeof D?D(g):D)||f.createElement(r,null),(function(){return S(g)}),m,w.removeFile):null,oe=U&&"done"===L?C(("function"==typeof T?T(g):T)||f.createElement(i,null),(function(){return A(g)}),m,w.downloadFile):null,re="picture-card"!==E&&f.createElement("span",{key:"download-delete",className:u("".concat(m,"-list-item-card-actions"),{picture:"picture"===E})},oe,te),ie=u("".concat(m,"-list-item-name")),ae=g.url?[f.createElement("a",t({key:"view",target:"_blank",rel:"noopener noreferrer",className:ie,title:g.name},ne,{href:g.url,onClick:function(e){return O(g,e)}}),g.name),re]:[f.createElement("span",{key:"view",className:ie,onClick:function(e){return O(g,e)},title:g.name},g.name),re],le=P?f.createElement("a",{href:g.url||g.thumbUrl,target:"_blank",rel:"noopener noreferrer",style:g.url||g.thumbUrl?void 0:{pointerEvents:"none",opacity:.5},onClick:function(e){return O(g,e)},title:w.previewFile},"function"==typeof F?F(g):F||f.createElement(a,null)):null,ce="picture-card"===E&&"uploading"!==L&&f.createElement("span",{className:"".concat(m,"-list-item-actions")},le,"done"===L&&oe,te);$=g.response&&"string"==typeof g.response?g.response:(null===(c=g.error)||void 0===c?void 0:c.statusText)||(null===(s=g.error)||void 0===s?void 0:s.message)||w.uploadError;var se=f.createElement("span",{className:q},Q,ae),me=(0,f.useContext(k).getPrefixCls)(),ue=f.createElement("div",{className:ee},f.createElement("div",{className:"".concat(m,"-list-item-info")},se),ce,M&&f.createElement(d,{motionName:"".concat(me,"-fade"),visible:"uploading"===L,motionDeadline:2e3},(function(e){var n=e.className,o="percent"in g?f.createElement(N,t({},h,{type:"line",percent:g.percent})):null;return f.createElement("div",{className:u("".concat(m,"-list-item-progress"),n)},o)}))),de=u("".concat(m,"-list-").concat(E,"-container"),p),pe="error"===L?f.createElement(I,{title:$,getPopupContainer:function(e){return e.parentNode}},ue):ue;return f.createElement("div",{className:de,style:v,ref:l},j?j(pe,g,y,{download:A.bind(null,g),preview:O.bind(null,g),remove:S.bind(null,g)}):pe)}));var j=t({},g);delete j.onAppearEnd,delete j.onEnterEnd,delete j.onLeaveEnd;var R=function(r,i){var a=r.listType,g=void 0===a?"text":a,N=r.previewFile,I=void 0===N?h:N,R=r.onPreview,P=r.onDownload,x=r.onRemove,U=r.locale,F=r.iconRender,D=r.isImageUrl,T=void 0===D?b:D,O=r.prefixCls,A=r.items,S=void 0===A?[]:A,_=r.showPreviewIcon,B=void 0===_||_,J=r.showRemoveIcon,L=void 0===J||J,z=r.showDownloadIcon,H=void 0!==z&&z,K=r.removeIcon,M=r.previewIcon,V=r.downloadIcon,W=r.progress,q=void 0===W?{strokeWidth:2,showInfo:!1}:W,G=r.appendAction,Q=r.appendActionVisible,X=void 0===Q||Q,Y=r.itemRender,Z=r.disabled,$=y(),ee=f.useState(!1),ne=e(ee,2),te=ne[0],oe=ne[1];f.useEffect((function(){"picture"!==g&&"picture-card"!==g||(S||[]).forEach((function(e){"undefined"!=typeof document&&"undefined"!=typeof window&&window.FileReader&&window.File&&(e.originFileObj instanceof File||e.originFileObj instanceof Blob)&&void 0===e.thumbUrl&&(e.thumbUrl="",I&&I(e.originFileObj).then((function(n){e.thumbUrl=n||"",$()})))}))}),[g,S,I]),f.useEffect((function(){oe(!0)}),[]);var re=function(e,n){if(R)return null==n||n.preventDefault(),R(e)},ie=function(e){"function"==typeof P?P(e):e.url&&window.open(e.url)},ae=function(e){null==x||x(e)},le=function(e){if(F)return F(e,g);var n="uploading"===e.status,t=T&&T(e)?f.createElement(l,null):f.createElement(c,null),o=n?f.createElement(s,null):f.createElement(m,null);return"picture"===g?o=n?f.createElement(s,null):t:"picture-card"===g&&(o=n?U.uploading:t),o},ce=function(e,n,o,r){var i={type:"text",size:"small",title:r,disabled:Z,onClick:function(t){n(),w(e)&&e.props.onClick&&e.props.onClick(t)},className:"".concat(o,"-list-item-card-actions-btn")};if(w(e)){var a=v(e,t(t({},e.props),{onClick:function(){}}));return f.createElement(E,t({},i,{icon:a}))}return f.createElement(E,t({},i),f.createElement("span",null,e))};f.useImperativeHandle(i,(function(){return{handlePreview:re,handleDownload:ie}}));var se=f.useContext(k),me=se.getPrefixCls,ue=se.direction,de=me("upload",O),pe=u(n(n(n({},"".concat(de,"-list"),!0),"".concat(de,"-list-").concat(g),!0),"".concat(de,"-list-rtl"),"rtl"===ue)),fe=o(S.map((function(e){return{key:e.uid,file:e}}))),ve="picture-card"===g?"animate-inline":"animate",we={motionDeadline:2e3,motionName:"".concat(de,"-").concat(ve),keys:fe,motionAppear:te};return"picture-card"!==g&&(we=t(t({},j),we)),f.createElement("div",{className:pe},f.createElement(p,t({},we,{component:!1}),(function(e){var n=e.key,t=e.file,o=e.className,r=e.style;return f.createElement(C,{key:n,locale:U,prefixCls:de,className:o,style:r,file:t,items:S,progress:q,listType:g,isImgUrl:T,showPreviewIcon:B,showRemoveIcon:L,showDownloadIcon:H,removeIcon:K,previewIcon:M,downloadIcon:V,iconRender:le,actionIconRender:ce,itemRender:Y,onPreview:re,onDownload:ie,onClose:ae})})),G&&f.createElement(d,t({},we,{visible:X,forceRender:!0}),(function(e){var n=e.className,o=e.style;return v(G,(function(e){return{className:u(e.className,n),style:t(t(t({},o),{pointerEvents:n?"none":void 0}),e.style)}}))})))};const P=f.forwardRef(R);export{P as U};
