import{i as e,j as n,k as t,_ as o}from"./vendor-tone-esm.8edb30e2.js";import{r as a}from"./vendor-react-core.73efc664.js";import{ar as r,Q as c,af as u,as as s,aa as i,at as l}from"./vendor-tone-util.a79eb63f.js";import{c as p}from"./vendor-tone-classnames.ea5eadd4.js";import{F as m,T as d}from"./vendor-tone-es.9387ac1c.js";import{t as f,v}from"./vendor-tone-hooks.ee856eec.js";var h=function(n,t){var o,u,s=n.prefixCls,i=n.id,l=n.inputElement,m=n.disabled,d=n.tabIndex,f=n.autoFocus,v=n.autoComplete,h=n.editable,b=n.activeDescendantId,C=n.value,g=n.maxLength,E=n.onKeyDown,I=n.onMouseDown,x=n.onChange,D=n.onPaste,y=n.onCompositionStart,w=n.onCompositionEnd,S=n.open,N=n.attrs,R=l||a.createElement("input",null),F=R,M=F.ref,P=F.props,T=P.onKeyDown,K=P.onChange,j=P.onMouseDown,k=P.onCompositionStart,L=P.onCompositionEnd,V=P.style;return r(!("maxLength"in R.props)),R=a.cloneElement(R,e(e(e({type:"search"},P),{},{id:i,ref:c(t,M),disabled:m,tabIndex:d,autoComplete:v||"off",autoFocus:f,className:p("".concat(s,"-selection-search-input"),null===(o=R)||void 0===o||null===(u=o.props)||void 0===u?void 0:u.className),role:"combobox","aria-expanded":S,"aria-haspopup":"listbox","aria-owns":"".concat(i,"_list"),"aria-autocomplete":"list","aria-controls":"".concat(i,"_list"),"aria-activedescendant":b},N),{},{value:h?C:"",maxLength:g,readOnly:!h,unselectable:h?null:"on",style:e(e({},V),{},{opacity:h?null:0}),onKeyDown:function(e){E(e),T&&T(e)},onMouseDown:function(e){I(e),j&&j(e)},onChange:function(e){x(e),K&&K(e)},onCompositionStart:function(e){y(e),k&&k(e)},onCompositionEnd:function(e){w(e),L&&L(e)},onPaste:D}))},b=a.forwardRef(h);function C(e){var n;return null!==(n=e.key)&&void 0!==n?n:e.value}b.displayName="Input";var g=function(e){e.preventDefault(),e.stopPropagation()},E=function(e){var o=e.id,r=e.prefixCls,c=e.values,i=e.open,l=e.searchValue,v=e.autoClearSearchValue,h=e.inputRef,E=e.placeholder,I=e.disabled,x=e.mode,D=e.showSearch,y=e.autoFocus,w=e.autoComplete,S=e.activeDescendantId,N=e.tabIndex,R=e.removeIcon,F=e.maxTagCount,M=e.maxTagTextLength,P=e.maxTagPlaceholder,T=void 0===P?function(e){return"+ ".concat(e.length," ...")}:P,K=e.tagRender,j=e.onToggleOpen,k=e.onRemove,L=e.onInputChange,V=e.onInputPaste,O=e.onInputKeyDown,W=e.onInputMouseDown,_=e.onInputCompositionStart,U=e.onInputCompositionEnd,z=a.useRef(null),A=a.useState(0),B=n(A,2),H=B[0],Q=B[1],$=a.useState(!1),q=n($,2),G=q[0],J=q[1],X="".concat(r,"-selection"),Y=i||"multiple"===x&&!1===v||"tags"===x?l:"",Z="tags"===x||"multiple"===x&&!1===v||D&&(i||G);function ee(e,n,o,r,c){return a.createElement("span",{className:p("".concat(X,"-item"),t({},"".concat(X,"-item-disabled"),o)),title:s(e)},a.createElement("span",{className:"".concat(X,"-item-content")},n),r&&a.createElement(d,{className:"".concat(X,"-item-remove"),onMouseDown:g,onClick:c,customizeIcon:R},"×"))}f((function(){Q(z.current.scrollWidth)}),[Y]);var ne=a.createElement("div",{className:"".concat(X,"-search"),style:{width:H},onFocus:function(){J(!0)},onBlur:function(){J(!1)}},a.createElement(b,{ref:h,open:i,prefixCls:r,id:o,inputElement:null,disabled:I,autoFocus:y,autoComplete:w,editable:Z,activeDescendantId:S,value:Y,onKeyDown:O,onMouseDown:W,onChange:L,onPaste:V,onCompositionStart:_,onCompositionEnd:U,tabIndex:N,attrs:u(e,!0)}),a.createElement("span",{ref:z,className:"".concat(X,"-search-mirror"),"aria-hidden":!0},Y," ")),te=a.createElement(m,{prefixCls:"".concat(X,"-overflow"),data:c,renderItem:function(e){var n=e.disabled,t=e.label,o=e.value,r=!I&&!n,c=t;if("number"==typeof M&&("string"==typeof t||"number"==typeof t)){var u=String(c);u.length>M&&(c="".concat(u.slice(0,M),"..."))}var s=function(n){n&&n.stopPropagation(),k(e)};return"function"==typeof K?function(e,n,t,o,r){return a.createElement("span",{onMouseDown:function(e){g(e),j(!i)}},K({label:n,value:e,disabled:t,closable:o,onClose:r}))}(o,c,n,r,s):ee(e,c,n,r,s)},renderRest:function(e){var n="function"==typeof T?T(e):T;return ee({title:n},n,!1)},suffix:ne,itemKey:C,maxCount:F});return a.createElement(a.Fragment,null,te,!c.length&&!Y&&a.createElement("span",{className:"".concat(X,"-placeholder")},E))},I=function(e){var t=e.inputElement,o=e.prefixCls,r=e.id,c=e.inputRef,i=e.disabled,l=e.autoFocus,p=e.autoComplete,m=e.activeDescendantId,d=e.mode,f=e.open,v=e.values,h=e.placeholder,C=e.tabIndex,g=e.showSearch,E=e.searchValue,I=e.activeValue,x=e.maxLength,D=e.onInputKeyDown,y=e.onInputMouseDown,w=e.onInputChange,S=e.onInputPaste,N=e.onInputCompositionStart,R=e.onInputCompositionEnd,F=a.useState(!1),M=n(F,2),P=M[0],T=M[1],K="combobox"===d,j=K||g,k=v[0],L=E||"";K&&I&&!P&&(L=I),a.useEffect((function(){K&&T(!1)}),[K,I]);var V=!("combobox"!==d&&!f&&!g)&&!!L,O=s(k);return a.createElement(a.Fragment,null,a.createElement("span",{className:"".concat(o,"-selection-search")},a.createElement(b,{ref:c,prefixCls:o,id:r,open:f,inputElement:t,disabled:i,autoFocus:l,autoComplete:p,editable:j,activeDescendantId:m,value:L,onKeyDown:D,onMouseDown:y,onChange:function(e){T(!0),w(e)},onPaste:S,onCompositionStart:N,onCompositionEnd:R,tabIndex:C,attrs:u(e,!0),maxLength:K?x:void 0})),!K&&k?a.createElement("span",{className:"".concat(o,"-selection-item"),title:O,style:V?{visibility:"hidden"}:void 0},k.label):null,function(){if(k)return null;var e=V?{visibility:"hidden"}:void 0;return a.createElement("span",{className:"".concat(o,"-selection-placeholder"),style:e},h)}())},x=function(e,t){var r=a.useRef(null),c=a.useRef(!1),u=e.prefixCls,s=e.open,p=e.mode,m=e.showSearch,d=e.tokenWithEnter,f=e.autoClearSearchValue,h=e.onSearch,b=e.onSearchSubmit,C=e.onToggleOpen,g=e.onInputKeyDown,x=e.domRef;a.useImperativeHandle(t,(function(){return{focus:function(){r.current.focus()},blur:function(){r.current.blur()}}}));var D=v(0),y=n(D,2),w=y[0],S=y[1],N=a.useRef(null),R=function(e){!1!==h(e,!0,c.current)&&C(!0)},F={inputRef:r,onInputKeyDown:function(e){var n=e.which;n!==i.UP&&n!==i.DOWN||e.preventDefault(),g&&g(e),n!==i.ENTER||"tags"!==p||c.current||s||null==b||b(e.target.value),l(n)&&C(!0)},onInputMouseDown:function(){S(!0)},onInputChange:function(e){var n=e.target.value;if(d&&N.current&&/[\r\n]/.test(N.current)){var t=N.current.replace(/[\r\n]+$/,"").replace(/\r\n/g," ").replace(/[\r\n]/g," ");n=n.replace(t,N.current)}N.current=null,R(n)},onInputPaste:function(e){var n=e.clipboardData.getData("text");N.current=n},onInputCompositionStart:function(){c.current=!0},onInputCompositionEnd:function(e){c.current=!1,"combobox"!==p&&R(e.target.value)}},M="multiple"===p||"tags"===p?a.createElement(E,o({},e,F)):a.createElement(I,o({},e,F));return a.createElement("div",{ref:x,className:"".concat(u,"-selector"),onClick:function(e){e.target!==r.current&&(void 0!==document.body.style.msTouchAction?setTimeout((function(){r.current.focus()})):r.current.focus())},onMouseDown:function(e){var n=w();e.target===r.current||n||"combobox"===p||e.preventDefault(),("combobox"===p||m&&n)&&s||(s&&!1!==f&&h("",!0,!1),C())}},M)},D=a.forwardRef(x);D.displayName="Selector";export{D as F};
