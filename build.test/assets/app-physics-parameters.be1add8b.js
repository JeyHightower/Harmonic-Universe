import{r as e,j as s}from"./vendor-react-core.73efc664.js";import a from"./app-services-api.399edcf9.js";import{e as r}from"./app-services-other.47edd63d.js";import{h as i,B as t,d as l,I as n,M as c}from"./app-other-components.5e297c7e.js";import"./vendor-react-redux.ca23f922.js";import"./app-modals.11788519.js";import"./app-redux-scene-thunks.d96f7130.js";const d={name:"",description:"",gravity_x:0,gravity_y:-9.81,gravity_z:0,time_scale:1,air_resistance:.1,friction:.5,bounce_factor:.7,solver_iterations:10,scene_id:null},o=({sceneId:r,paramsId:c,onClose:o,onSuccess:m,mode:p="create",initialData:h=null})=>{const[u,v]=e.useState({...d,scene_id:r}),[x,y]=e.useState({}),[j,g]=e.useState(!1),[N,b]=e.useState(null),[_,f]=e.useState(null),[w,C]=e.useState("edit"===p||"view"===p);e.useEffect((()=>{!h||"edit"!==p&&"view"!==p&&"delete"!==p?(async()=>{if(("edit"===p||"view"===p||"delete"===p)&&c)try{C(!0);const e=await a.get(`${endpoints.scenes.detail(r)}/physics_parameters/${c}`);v({...e.data,scene_id:r})}catch(e){b("Failed to load physics parameters. Please try again.")}finally{C(!1)}})():(v({...h,scene_id:r}),C(!1))}),[p,c,r,h]);const S=e=>{const{name:s,value:a,type:r}=e.target,i="number"===r?parseFloat(a):a;v((e=>({...e,[s]:i}))),x[s]&&y((e=>({...e,[s]:null})))},P=()=>{const e={};return Object.entries(u).forEach((([s,a])=>{const r=((e,s)=>{switch(e){case"name":return s&&""!==s.trim()?s.length>100?"Name must be less than 100 characters":null:"Name is required";case"description":return s&&s.length>500?"Description must be less than 500 characters":null;case"gravity_x":case"gravity_y":case"gravity_z":return null==s||isNaN(s)?"Gravity must be a valid number":null;case"time_scale":return null==s||isNaN(s)?"Time scale must be a valid number":s<=0?"Time scale must be greater than 0":null;case"air_resistance":return null==s||isNaN(s)?"Air resistance must be a valid number":s<0?"Air resistance must be greater than or equal to 0":null;case"friction":case"bounce_factor":return null==s||isNaN(s)?"Value must be a valid number":s<0||s>1?"Value must be between 0 and 1":null;case"solver_iterations":return null==s||isNaN(s)?"Solver iterations must be a valid number":!Number.isInteger(Number(s))||s<1?"Solver iterations must be a positive integer":null;default:return null}})(s,a);r&&(e[s]=r)})),y(e),0===Object.keys(e).length},F=async e=>{if(e.preventDefault(),"view"!==p){if("delete"===p||P()){g(!0),b(null),f(null);try{let e;"create"===p?(e=await a.post(`${endpoints.scenes.detail(r)}/physics_parameters`,u),f("Physics parameters created successfully!")):"edit"===p?(e=await a.put(`${endpoints.scenes.detail(r)}/physics_parameters/${c}`,u),f("Physics parameters updated successfully!")):"delete"===p&&(e=await a.delete(`${endpoints.scenes.detail(r)}/physics_parameters/${c}`),f("Physics parameters deleted successfully!")),e&&m&&m(e.data||u,p),setTimeout((()=>{o()}),1500)}catch(s){s.response&&s.response.data&&s.response.data.errors?y(s.response.data.errors):b("An error occurred while processing your request. Please try again.")}finally{g(!1)}}}else o()};return s.jsxs("div",{className:"physics-parameters-modal",children:[s.jsxs("div",{className:"modal-header",children:[s.jsxs("h2",{className:"modal-title",children:[s.jsx(i,{name:"physics"})," ",(()=>{switch(p){case"create":return"Create Physics Parameters";case"edit":return"Edit Physics Parameters";case"view":return"Physics Parameters Details";case"delete":return"Delete Physics Parameters";default:return"Physics Parameters"}})()]}),s.jsx(t,{variant:"icon",onClick:o,icon:"close",disabled:j})]}),s.jsx("div",{className:"modal-content",children:w?s.jsxs("div",{className:"loading-container",children:[s.jsx(l,{size:"large"}),s.jsx("p",{children:"Loading physics parameters..."})]}):"delete"===p?s.jsxs("div",{className:"delete-confirmation",children:[s.jsx(i,{name:"warning",size:"large"}),s.jsxs("p",{children:["Are you sure you want to delete"," ",s.jsx("strong",{children:u.name||"these physics parameters"}),"?"]}),s.jsx("p",{children:"This action cannot be undone."}),s.jsxs("div",{className:"modal-actions",children:[s.jsx(t,{variant:"secondary",onClick:o,disabled:j,children:"Cancel"}),s.jsx(t,{variant:"danger",onClick:F,loading:j,children:"Delete"})]}),N&&s.jsx("div",{className:"error-message",children:N}),_&&s.jsx("div",{className:"success-message",children:_})]}):s.jsxs("form",{onSubmit:F,className:"physics-parameters-form",children:[s.jsx("div",{className:"form-group",children:s.jsx(n,{label:"Name",name:"name",value:u.name,onChange:S,error:x.name,disabled:"view"===p,required:"view"!==p,placeholder:"Enter parameter set name"})}),s.jsx("div",{className:"form-group",children:s.jsx(n,{label:"Description",name:"description",value:u.description,onChange:S,error:x.description,disabled:"view"===p,multiline:!0,rows:3,placeholder:"Enter optional description"})}),s.jsxs("div",{className:"form-section",children:[s.jsx("h3",{children:"Gravity"}),s.jsxs("div",{className:"form-row",children:[s.jsx("div",{className:"form-group",children:s.jsx(n,{label:"X-axis",name:"gravity_x",type:"number",value:u.gravity_x,onChange:S,error:x.gravity_x,disabled:"view"===p,placeholder:"0",step:"0.01"})}),s.jsx("div",{className:"form-group",children:s.jsx(n,{label:"Y-axis",name:"gravity_y",type:"number",value:u.gravity_y,onChange:S,error:x.gravity_y,disabled:"view"===p,placeholder:"-9.81",step:"0.01"})}),s.jsx("div",{className:"form-group",children:s.jsx(n,{label:"Z-axis",name:"gravity_z",type:"number",value:u.gravity_z,onChange:S,error:x.gravity_z,disabled:"view"===p,placeholder:"0",step:"0.01"})})]})]}),s.jsxs("div",{className:"form-section",children:[s.jsx("h3",{children:"Simulation Settings"}),s.jsxs("div",{className:"form-row",children:[s.jsx("div",{className:"form-group",children:s.jsx(n,{label:"Time Scale",name:"time_scale",type:"number",value:u.time_scale,onChange:S,error:x.time_scale,disabled:"view"===p,placeholder:"1.0",min:"0.1",step:"0.1"})}),s.jsx("div",{className:"form-group",children:s.jsx(n,{label:"Solver Iterations",name:"solver_iterations",type:"number",value:u.solver_iterations,onChange:S,error:x.solver_iterations,disabled:"view"===p,placeholder:"10",min:"1",step:"1"})})]})]}),s.jsxs("div",{className:"form-section",children:[s.jsx("h3",{children:"Material Properties"}),s.jsxs("div",{className:"form-row",children:[s.jsx("div",{className:"form-group",children:s.jsx(n,{label:"Air Resistance",name:"air_resistance",type:"number",value:u.air_resistance,onChange:S,error:x.air_resistance,disabled:"view"===p,placeholder:"0.1",min:"0",max:"1",step:"0.01"})}),s.jsx("div",{className:"form-group",children:s.jsx(n,{label:"Friction",name:"friction",type:"number",value:u.friction,onChange:S,error:x.friction,disabled:"view"===p,placeholder:"0.5",min:"0",max:"1",step:"0.01"})}),s.jsx("div",{className:"form-group",children:s.jsx(n,{label:"Bounce Factor",name:"bounce_factor",type:"number",value:u.bounce_factor,onChange:S,error:x.bounce_factor,disabled:"view"===p,placeholder:"0.7",min:"0",max:"1",step:"0.01"})})]})]}),s.jsxs("div",{className:"modal-actions",children:[s.jsx(t,{variant:"secondary",onClick:o,disabled:j,children:"view"===p?"Close":"Cancel"}),"view"!==p&&s.jsx(t,{variant:"primary",type:"submit",loading:j,children:"create"===p?"Create":"Save Changes"})]}),N&&s.jsx("div",{className:"error-message",children:N}),_&&s.jsx("div",{className:"success-message",children:_})]})})]})},m=Object.freeze(Object.defineProperty({__proto__:null,default:o},Symbol.toStringTag,{value:"Module"})),p=Object.freeze(Object.defineProperty({__proto__:null,default:({sceneId:n})=>{const[d,m]=e.useState(!0),[p,h]=e.useState(null),[u,v]=e.useState([]),[x,y]=e.useState(null),[j,g]=e.useState(!1),[N,b]=e.useState("create"),[_,f]=e.useState(null);e.useEffect((()=>{(async()=>{if(n)try{m(!0),h(null);const e=await a.get(r.scenes.physicsParameters.list(n));v(e.data||[]),e.data&&e.data.length>0&&!x&&y(e.data[0].id)}catch(e){h("Failed to load physics parameters. Please try again.")}finally{m(!1)}})()}),[n,x]);const w=()=>{f(null),b("create"),g(!0)},C=e=>{f(e),b("edit"),g(!0)},S=()=>{g(!1),f(null)},P=async e=>{try{await a.post(`${r.scenes.detail(n)}/physics_parameters/${e.id}/apply`),v((s=>s.map((s=>({...s,is_active:s.id===e.id})))))}catch(s){}};return s.jsxs("div",{className:"physics-parameters-manager",children:[s.jsxs("div",{className:"physics-parameters-manager-header",children:[s.jsxs("h2",{children:[s.jsx(i,{name:"physics"})," Physics Parameters"]}),s.jsx(t,{variant:"primary",icon:"plus",onClick:w,children:"Create Parameters"})]}),s.jsxs("div",{className:"physics-parameters-manager-content",children:[s.jsx("div",{className:"physics-parameters-sidebar",children:d?s.jsxs("div",{className:"loading-container",children:[s.jsx(l,{size:"large"}),s.jsx("p",{children:"Loading physics parameters..."})]}):p?s.jsxs("div",{className:"error-message",children:[s.jsx(i,{name:"error"})," ",p]}):0===u.length?s.jsxs("div",{className:"empty-message",children:[s.jsx(i,{name:"physics",size:"large"}),s.jsx("p",{children:"No physics parameters found for this scene."}),s.jsx(t,{variant:"primary",onClick:w,icon:"plus",children:"Create Physics Parameters"})]}):s.jsx("div",{className:"physics-parameters-list",children:u.map((e=>s.jsxs("div",{className:`physics-parameters-item ${x===e.id?"selected":""} ${e.is_active?"active":""}`,onClick:()=>y(e.id),children:[s.jsxs("div",{className:"physics-parameters-item-content",children:[s.jsxs("h3",{children:[e.name||"Unnamed Parameters",e.is_active&&s.jsx("span",{className:"active-badge",children:"Active"})]}),e.description&&s.jsx("p",{children:e.description}),s.jsxs("div",{className:"physics-parameters-item-details",children:[s.jsxs("span",{children:["Gravity: (",e.gravity_x.toFixed(2),","," ",e.gravity_y.toFixed(2),", ",e.gravity_z.toFixed(2),")"]}),s.jsxs("span",{children:["Time Scale: ",e.time_scale.toFixed(2),"x"]})]})]}),s.jsxs("div",{className:"physics-parameters-item-actions",children:[s.jsx(t,{variant:"text",icon:"view",tooltip:"View Details",onClick:s=>{s.stopPropagation(),(e=>{f(e),b("view"),g(!0)})(e)}}),s.jsx(t,{variant:"text",icon:"edit",tooltip:"Edit",onClick:s=>{s.stopPropagation(),C(e)}}),s.jsx(t,{variant:"text",icon:"delete",tooltip:"Delete",onClick:s=>{s.stopPropagation(),(e=>{f(e),b("delete"),g(!0)})(e)}}),!e.is_active&&s.jsx(t,{variant:"text",icon:"play",tooltip:"Apply to Scene",onClick:s=>{s.stopPropagation(),P(e)}})]})]},e.id)))})}),s.jsx("div",{className:"physics-parameters-main",children:(()=>{if(!x||0===u.length)return null;const e=u.find((e=>e.id===x));return e?s.jsxs("div",{className:"physics-parameters-details",children:[s.jsxs("h2",{className:"physics-parameters-details-title",children:[e.name||"Unnamed Parameters",e.is_active&&s.jsx("span",{className:"active-badge",children:"Active"})]}),e.description&&s.jsx("p",{className:"physics-parameters-description",children:e.description}),s.jsxs("div",{className:"physics-parameters-properties",children:[s.jsxs("div",{className:"property-section",children:[s.jsx("h3",{children:"Gravity"}),s.jsxs("div",{className:"property-grid",children:[s.jsxs("div",{className:"property-item",children:[s.jsx("span",{className:"property-label",children:"X-axis:"}),s.jsx("span",{className:"property-value",children:e.gravity_x.toFixed(2)})]}),s.jsxs("div",{className:"property-item",children:[s.jsx("span",{className:"property-label",children:"Y-axis:"}),s.jsx("span",{className:"property-value",children:e.gravity_y.toFixed(2)})]}),s.jsxs("div",{className:"property-item",children:[s.jsx("span",{className:"property-label",children:"Z-axis:"}),s.jsx("span",{className:"property-value",children:e.gravity_z.toFixed(2)})]})]})]}),s.jsxs("div",{className:"property-section",children:[s.jsx("h3",{children:"Simulation Settings"}),s.jsxs("div",{className:"property-grid",children:[s.jsxs("div",{className:"property-item",children:[s.jsx("span",{className:"property-label",children:"Time Scale:"}),s.jsxs("span",{className:"property-value",children:[e.time_scale.toFixed(2),"x"]})]}),s.jsxs("div",{className:"property-item",children:[s.jsx("span",{className:"property-label",children:"Solver Iterations:"}),s.jsx("span",{className:"property-value",children:e.solver_iterations})]})]})]}),s.jsxs("div",{className:"property-section",children:[s.jsx("h3",{children:"Material Properties"}),s.jsxs("div",{className:"property-grid",children:[s.jsxs("div",{className:"property-item",children:[s.jsx("span",{className:"property-label",children:"Air Resistance:"}),s.jsx("span",{className:"property-value",children:e.air_resistance.toFixed(2)})]}),s.jsxs("div",{className:"property-item",children:[s.jsx("span",{className:"property-label",children:"Bounce Factor:"}),s.jsx("span",{className:"property-value",children:e.bounce_factor.toFixed(2)})]}),s.jsxs("div",{className:"property-item",children:[s.jsx("span",{className:"property-label",children:"Friction:"}),s.jsx("span",{className:"property-value",children:e.friction.toFixed(2)})]})]})]})]}),s.jsxs("div",{className:"physics-parameters-actions",children:[s.jsx(t,{variant:"secondary",icon:"edit",onClick:()=>C(e),children:"Edit"}),!e.is_active&&s.jsx(t,{variant:"primary",icon:"play",onClick:()=>P(e),children:"Apply to Scene"})]})]}):null})()})]}),s.jsx(c,{isVisible:j,onClose:S,width:"600px",children:j&&s.jsx(o,{sceneId:n,paramsId:null==_?void 0:_.id,onClose:S,onSuccess:(e,s)=>{if("create"===s)v((s=>[...s,e])),y(e.id);else if("edit"===s)v((s=>s.map((s=>s.id===e.id?e:s))));else if("delete"===s&&(v((s=>s.filter((s=>s.id!==e.id)))),x===e.id)){const s=u.filter((s=>s.id!==e.id));y(s.length>0?s[0].id:null)}},mode:N,initialData:_})})]})}},Symbol.toStringTag,{value:"Module"}));export{m as P,p as a};
