import{r as e,j as s}from"./vendor-react-core.73efc664.js";import{u as i,a as t}from"./vendor-react-redux.ca23f922.js";import{u as n}from"./app-contexts.6347d155.js";import{h as a,i as r,e as l,b as o}from"./app-redux-physics-thunks.c58b7b1a.js";import{M as c}from"./app-constants.4a812be2.js";import{B as d,h as p,I as m}from"./app-other-components.5e297c7e.js";import"./app-core.4fc76094.js";import"./app-modals.11788519.js";import"./app-redux-scene-thunks.d96f7130.js";import h from"./app-physics-list.9dc0d346.js";import{F as j}from"./vendor-tone-form.6dd4e248.js";import{C as x}from"./vendor-tone-card.8385b307.js";import{I as y}from"./vendor-tone-input.876080ec.js";import{R as u,C as _}from"./vendor-tone-grid.9235ce83.js";import{I as v}from"./vendor-tone-input-number.28372503.js";import{S as f}from"./vendor-tone-switch.4218e0a6.js";import{S as b}from"./vendor-tone-select.c6c7620f.js";import{D as g}from"./vendor-tone-divider.a6c32c3c.js";import{B as w}from"./vendor-tone-button.429dcaea.js";import{T as I}from"./vendor-tone-typography.2404bb54.js";const S={gravity:{value:9.81,unit:"m/s²",min:.01,max:20,warning_threshold:1},air_resistance:{value:0,unit:"kg/m³",min:0,max:1,warning_threshold:.001},elasticity:{value:1,unit:"coefficient",min:.1,max:1,warning_threshold:.2},friction:{value:.1,unit:"coefficient",min:.01,max:1,warning_threshold:.05},temperature:{value:293.15,unit:"K",min:1,max:1e3,warning_threshold:50},pressure:{value:101.325,unit:"kPa",min:.1,max:200,warning_threshold:10}};const C=Object.freeze(Object.defineProperty({__proto__:null,default:function({universeId:r,initialPhysicsParams:l,readOnly:o=!1,onPhysicsParamsChange:p}){const m=i(),{openModalByType:h}=n(),j=t((e=>e.universe.currentUniverse)),[x,y]=e.useState(null);e.useState({});const[u,_]=e.useState(!1),[v,f]=e.useState(!0),[b,g]=e.useState(null),w=!o&&(null===j?!o:"owner"===(null==j?void 0:j.user_role));e.useEffect((()=>{if(r)if(f(!0),(null==j?void 0:j.id)===r&&(null==j?void 0:j.physics_params)){const e=JSON.parse(JSON.stringify(j.physics_params)),s=Object.entries(e).reduce(((e,[s,i])=>({...e,[s]:{...S[s],...i}})),{});y(s),g(I(s)),f(!1)}else l?(y(l),g(I(l)),f(!1)):(y(S),g(I(S)),f(!1));else f(!1)}),[r,j,l]);const I=e=>e?Object.entries(e).reduce(((e,[s,i])=>({...e,[s]:i.value})),{}):{},C=async e=>{_(!0);try{y(e);const s=I(e);return g(s),r&&await m(a({universeId:r,physicsParams:s})).unwrap(),p&&p(e),!0}catch(s){return!1}finally{_(!1)}},P=(e,s)=>{if("number"!=typeof e)return"N/A";let i;return i=e<.01?e.toExponential(2):e<1?e.toFixed(3):e<10?e.toFixed(2):e<100?e.toFixed(1):e.toFixed(0),`${i} ${s}`};return v?s.jsxs("div",{className:"physics-panel physics-panel-loading",children:[s.jsx("div",{className:"physics-panel-header",children:s.jsx("h2",{children:"Physics Properties"})}),s.jsx("div",{className:"physics-panel-content",children:s.jsx("div",{className:"physics-loading-placeholder"})})]}):x?s.jsxs("div",{className:"physics-panel",children:[s.jsxs("div",{className:"physics-panel-header",children:[s.jsx("h2",{children:"Physics Properties"}),w&&s.jsx(d,{variant:"primary",onClick:()=>{h(c.PHYSICS_PARAMETERS,{universeId:r,initialData:x,onSave:C})},disabled:u,children:"Edit Physics"})]}),s.jsx("div",{className:"physics-panel-content",children:s.jsx("div",{className:"physics-grid",children:Object.entries(x).map((([e,i])=>s.jsxs("div",{className:"physics-property",children:[s.jsx("div",{className:"physics-property-label",children:e.charAt(0).toUpperCase()+e.slice(1).replace("_"," ")}),s.jsx("div",{className:"physics-property-value",children:P(i.value,i.unit)})]},e)))})})]}):null}},Symbol.toStringTag,{value:"Module"})),P=Object.freeze(Object.defineProperty({__proto__:null,default:({sceneId:a})=>{const l=i(),{openModalByType:o}=n(),{physicsObjects:m,loading:j,error:x}=t((e=>e.physicsObjects));e.useEffect((()=>{a&&l(r(a))}),[l,a]);const y=()=>{o(c.PHYSICS_OBJECT,{sceneId:a,onSuccess:()=>{l(r(a))}})};return s.jsxs("div",{className:"physics-objects-manager",children:[s.jsxs("div",{className:"physics-objects-header",children:[s.jsxs("h2",{className:"physics-objects-title",children:[s.jsx(p,{name:"physics",size:"medium",className:"title-icon"}),"Physics Objects"]}),s.jsxs("div",{className:"physics-objects-actions",children:[s.jsx(d,{onClick:()=>{l(r(a))},variant:"icon",title:"Refresh physics objects list",children:s.jsx(p,{name:"refresh",size:"medium"})}),s.jsxs(d,{onClick:y,variant:"primary",children:[s.jsx(p,{name:"add",size:"small"}),"Add Object"]})]})]}),s.jsx(h,{sceneId:a,objects:m,loading:j,error:x,onViewClick:e=>{const s=m.find((s=>s.id===e));o(c.PHYSICS_OBJECT,{sceneId:a,objectId:e,initialData:s,readOnly:!0})},onEditClick:e=>{const s=m.find((s=>s.id===e));o(c.PHYSICS_OBJECT,{sceneId:a,objectId:e,initialData:s,onSuccess:()=>{l(r(a))}})},onDeleteClick:e=>{const s=m.find((s=>s.id===e));s&&o(c.CONFIRM_DELETE,{entityType:"physics object",entityId:e,entityName:s.name,onConfirm:()=>{l(r(a))}})},onCreateClick:y})]})}},Symbol.toStringTag,{value:"Module"})),{Option:z}=b,{Title:O}=I,N=Object.freeze(Object.defineProperty({__proto__:null,default:({sceneId:n,onSuccess:a,onCancel:r,isEdit:c=!1})=>{const[d]=j.useForm(),p=i(),{currentPhysicsObject:m,loading:h}=t((e=>e.physicsObjects));e.useEffect((()=>{c&&m&&d.setFieldsValue({name:m.name,mass:m.mass,is_static:m.is_static,is_trigger:m.is_trigger,collision_shape:m.collision_shape,position_x:m.position.x,position_y:m.position.y,position_z:m.position.z,velocity_x:m.velocity.x,velocity_y:m.velocity.y,velocity_z:m.velocity.z,rotation_x:m.rotation.x,rotation_y:m.rotation.y,rotation_z:m.rotation.z,scale_x:m.scale.x,scale_y:m.scale.y,scale_z:m.scale.z,restitution:m.material_properties.restitution,friction:m.material_properties.friction,density:m.material_properties.density})}),[c,m,d]);return s.jsx(x,{title:s.jsx(O,{level:4,children:c?"Edit Physics Object":"Create Physics Object"}),children:s.jsxs(j,{form:d,layout:"vertical",onFinish:async e=>{const s={name:e.name,mass:e.mass,is_static:e.is_static,is_trigger:e.is_trigger,collision_shape:e.collision_shape,position:{x:e.position_x,y:e.position_y,z:e.position_z},velocity:{x:e.velocity_x,y:e.velocity_y,z:e.velocity_z},rotation:{x:e.rotation_x,y:e.rotation_y,z:e.rotation_z},scale:{x:e.scale_x,y:e.scale_y,z:e.scale_z},material_properties:{restitution:e.restitution,friction:e.friction,density:e.density}};if(c){!(await p(l({id:m.id,data:s}))).error&&a&&a()}else{!(await p(o({...s,scene_id:n}))).error&&a&&a()}},initialValues:{name:"",mass:1,is_static:!1,is_trigger:!1,collision_shape:"box",position_x:0,position_y:0,position_z:0,velocity_x:0,velocity_y:0,velocity_z:0,rotation_x:0,rotation_y:0,rotation_z:0,scale_x:1,scale_y:1,scale_z:1,restitution:.7,friction:.3,density:1},children:[s.jsx(j.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Please enter a name"}],children:s.jsx(y,{placeholder:"Enter object name"})}),s.jsxs(u,{gutter:16,children:[s.jsx(_,{span:8,children:s.jsx(j.Item,{name:"mass",label:"Mass",children:s.jsx(v,{min:0,step:.1,style:{width:"100%"}})})}),s.jsx(_,{span:8,children:s.jsx(j.Item,{name:"is_static",label:"Static",valuePropName:"checked",children:s.jsx(f,{})})}),s.jsx(_,{span:8,children:s.jsx(j.Item,{name:"is_trigger",label:"Trigger",valuePropName:"checked",children:s.jsx(f,{})})})]}),s.jsx(j.Item,{name:"collision_shape",label:"Collision Shape",children:s.jsxs(b,{children:[s.jsx(z,{value:"box",children:"Box"}),s.jsx(z,{value:"sphere",children:"Sphere"}),s.jsx(z,{value:"capsule",children:"Capsule"}),s.jsx(z,{value:"cylinder",children:"Cylinder"}),s.jsx(z,{value:"cone",children:"Cone"}),s.jsx(z,{value:"plane",children:"Plane"})]})}),s.jsx(g,{orientation:"left",children:"Position"}),s.jsxs(u,{gutter:16,children:[s.jsx(_,{span:8,children:s.jsx(j.Item,{name:"position_x",label:"X",children:s.jsx(v,{step:.1,style:{width:"100%"}})})}),s.jsx(_,{span:8,children:s.jsx(j.Item,{name:"position_y",label:"Y",children:s.jsx(v,{step:.1,style:{width:"100%"}})})}),s.jsx(_,{span:8,children:s.jsx(j.Item,{name:"position_z",label:"Z",children:s.jsx(v,{step:.1,style:{width:"100%"}})})})]}),s.jsx(g,{orientation:"left",children:"Velocity"}),s.jsxs(u,{gutter:16,children:[s.jsx(_,{span:8,children:s.jsx(j.Item,{name:"velocity_x",label:"X",children:s.jsx(v,{step:.1,style:{width:"100%"}})})}),s.jsx(_,{span:8,children:s.jsx(j.Item,{name:"velocity_y",label:"Y",children:s.jsx(v,{step:.1,style:{width:"100%"}})})}),s.jsx(_,{span:8,children:s.jsx(j.Item,{name:"velocity_z",label:"Z",children:s.jsx(v,{step:.1,style:{width:"100%"}})})})]}),s.jsx(g,{orientation:"left",children:"Rotation"}),s.jsxs(u,{gutter:16,children:[s.jsx(_,{span:8,children:s.jsx(j.Item,{name:"rotation_x",label:"X",children:s.jsx(v,{step:.1,style:{width:"100%"}})})}),s.jsx(_,{span:8,children:s.jsx(j.Item,{name:"rotation_y",label:"Y",children:s.jsx(v,{step:.1,style:{width:"100%"}})})}),s.jsx(_,{span:8,children:s.jsx(j.Item,{name:"rotation_z",label:"Z",children:s.jsx(v,{step:.1,style:{width:"100%"}})})})]}),s.jsx(g,{orientation:"left",children:"Scale"}),s.jsxs(u,{gutter:16,children:[s.jsx(_,{span:8,children:s.jsx(j.Item,{name:"scale_x",label:"X",children:s.jsx(v,{min:.1,step:.1,style:{width:"100%"}})})}),s.jsx(_,{span:8,children:s.jsx(j.Item,{name:"scale_y",label:"Y",children:s.jsx(v,{min:.1,step:.1,style:{width:"100%"}})})}),s.jsx(_,{span:8,children:s.jsx(j.Item,{name:"scale_z",label:"Z",children:s.jsx(v,{min:.1,step:.1,style:{width:"100%"}})})})]}),s.jsx(g,{orientation:"left",children:"Material Properties"}),s.jsxs(u,{gutter:16,children:[s.jsx(_,{span:8,children:s.jsx(j.Item,{name:"restitution",label:"Restitution",children:s.jsx(v,{min:0,max:1,step:.1,style:{width:"100%"}})})}),s.jsx(_,{span:8,children:s.jsx(j.Item,{name:"friction",label:"Friction",children:s.jsx(v,{min:0,max:1,step:.1,style:{width:"100%"}})})}),s.jsx(_,{span:8,children:s.jsx(j.Item,{name:"density",label:"Density",children:s.jsx(v,{min:0,step:.1,style:{width:"100%"}})})})]}),s.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:[s.jsx(w,{onClick:r,children:"Cancel"}),s.jsx(w,{type:"primary",htmlType:"submit",loading:h,children:c?"Update":"Create"})]})]})})}},Symbol.toStringTag,{value:"Module"})),E=Object.freeze(Object.defineProperty({__proto__:null,default:({initialPhysicsParams:i,onSave:t,onClose:n})=>{const[a,r]=e.useState(i),[l,o]=e.useState({}),[c,p]=e.useState(!1);e.useEffect((()=>{r(i)}),[i]);const h=(e,s)=>{const i=((e,s)=>{if("number"==typeof s){const i=a[e];if(s<i.min||s>i.max)return`Value must be between ${i.min} and ${i.max}`;if(s<=i.min+i.warning_threshold||s>=i.max-i.warning_threshold)return`Value is close to ${s<=i.min+i.warning_threshold?"minimum":"maximum"} limit`}return null})(e,s);r((i=>({...i,[e]:{...i[e],value:s}}))),o((s=>({...s,[e]:i})))};return s.jsx("div",{className:"physics-settings-modal",children:s.jsxs("div",{className:"modal-content",children:[s.jsx("h2",{children:"Physics Settings"}),s.jsx("p",{className:"modal-description",children:"Adjust the physical laws and properties of your universe. These settings will affect how objects interact within your simulation."}),s.jsx("div",{className:"physics-parameters-grid",children:Object.entries(a).map((([e,i])=>((e,i)=>{var t;const n=void 0!==l[e]&&null!==l[e],a=null==(t=l[e])?void 0:t.includes("close to");return s.jsx("div",{className:"physics-parameter",children:s.jsx(m,{label:`${e.charAt(0).toUpperCase()+e.slice(1).replace("_"," ")} (${i.unit})`,type:"number",value:i.value,onChange:s=>h(e,parseFloat(s)),min:i.min,max:i.max,step:(i.max-i.min)/100,error:n&&!a?l[e]:null,warning:a?l[e]:null})},e)})(e,i)))}),s.jsxs("div",{className:"modal-actions",children:[s.jsx(d,{variant:"secondary",onClick:n,disabled:c,children:"Cancel"}),s.jsx(d,{variant:"primary",onClick:async()=>{p(!0);try{if(Object.values(l).some((e=>null!==e)))throw new Error("Please fix the errors before saving.");await t(a),n()}catch(e){}finally{p(!1)}},loading:c,disabled:c||Object.values(l).some((e=>null!==e&&!e.includes("close to"))),children:"Save Changes"})]})]})})}},Symbol.toStringTag,{value:"Module"}));export{C as P,P as a,N as b,E as c};
