import{j as e,k as t,i as a,l as n,_ as o,q as r}from"./vendor-tone-esm.8edb30e2.js";import{r as i}from"./vendor-react-core.73efc664.js";import{c}from"./vendor-tone-classnames.ea5eadd4.js";import{E as l,M as s,D as u,g as f,R as d}from"./vendor-tone-es.9387ac1c.js";import{aa as v,aC as m,aD as p,ao as b,aE as h,av as g}from"./vendor-tone-util.a79eb63f.js";import{z as E,A as y,B as k,C,D as x,E as w}from"./vendor-tone-hooks.ee856eec.js";import{_ as N}from"./vendor-tone-type.9e20d569.js";import{T as R}from"./vendor-tone-TabPanelList.10481429.js";function T(e,t){var a=e.prefixCls,n=e.editable,o=e.locale,r=e.style;return n&&!1!==n.showAdd?i.createElement("button",{ref:t,type:"button",className:"".concat(a,"-nav-add"),style:r,"aria-label":(null==o?void 0:o.addAriaLabel)||"Add tab",onClick:function(e){n.onEdit("add",{event:e})}},n.addIcon||"+"):null}const D=i.forwardRef(T);var I=i.forwardRef((function(e,t){var a,n=e.position,o=e.prefixCls,r=e.extra;if(!r)return null;var c={};return"object"!==N(r)||i.isValidElement(r)?c.right=r:c=r,"right"===n&&(a=c.right),"left"===n&&(a=c.left),a?i.createElement("div",{className:"".concat(o,"-extra-content"),ref:t},a):null}));function A(a,n){var o=a.prefixCls,r=a.id,f=a.tabs,d=a.locale,m=a.mobile,p=a.moreIcon,b=void 0===p?"More":p,h=a.moreTransitionName,g=a.style,E=a.className,y=a.editable,k=a.tabBarGutter,C=a.rtl,x=a.removeAriaLabel,w=a.onTabClick,N=a.getPopupContainer,R=a.popupClassName,T=i.useState(!1),I=e(T,2),A=I[0],L=I[1],S=i.useState(null),P=e(S,2),j=P[0],M=P[1],B="".concat(r,"-more-popup"),K="".concat(o,"-dropdown"),W=null!==j?"".concat(B,"-").concat(j):null,F=null==d?void 0:d.dropdownAriaLabel;var V=i.createElement(l,{onClick:function(e){var t=e.key,a=e.domEvent;w(t,a),L(!1)},prefixCls:"".concat(K,"-menu"),id:B,tabIndex:-1,role:"listbox","aria-activedescendant":W,selectedKeys:[j],"aria-label":void 0!==F?F:"expanded dropdown"},f.map((function(e){var t=y&&!1!==e.closable&&!e.disabled;return i.createElement(s,{key:e.key,id:"".concat(B,"-").concat(e.key),role:"option","aria-controls":r&&"".concat(r,"-panel-").concat(e.key),disabled:e.disabled},i.createElement("span",null,e.label),t&&i.createElement("button",{type:"button","aria-label":x||"remove",tabIndex:0,className:"".concat(K,"-menu-item-remove"),onClick:function(t){var a,n;t.stopPropagation(),a=t,n=e.key,a.preventDefault(),a.stopPropagation(),y.onEdit("remove",{key:n,event:a})}},e.closeIcon||y.removeIcon||"×"))})));function z(e){for(var t=f.filter((function(e){return!e.disabled})),a=t.findIndex((function(e){return e.key===j}))||0,n=t.length,o=0;o<n;o+=1){var r=t[a=(a+e+n)%n];if(!r.disabled)return void M(r.key)}}i.useEffect((function(){var e=document.getElementById(W);e&&e.scrollIntoView&&e.scrollIntoView(!1)}),[j]),i.useEffect((function(){A||M(null)}),[A]);var G=t({},C?"marginRight":"marginLeft",k);f.length||(G.visibility="hidden",G.order=1);var _=c(t({},"".concat(K,"-rtl"),C)),q=m?null:i.createElement(u,{prefixCls:K,overlay:V,trigger:["hover"],visible:!!f.length&&A,transitionName:h,onVisibleChange:L,overlayClassName:c(_,R),mouseEnterDelay:.1,mouseLeaveDelay:.1,getPopupContainer:N},i.createElement("button",{type:"button",className:"".concat(o,"-nav-more"),style:G,tabIndex:-1,"aria-hidden":"true","aria-haspopup":"listbox","aria-controls":B,id:"".concat(r,"-more"),"aria-expanded":A,onKeyDown:function(e){var t=e.which;if(A)switch(t){case v.UP:z(-1),e.preventDefault();break;case v.DOWN:z(1),e.preventDefault();break;case v.ESC:L(!1);break;case v.SPACE:case v.ENTER:null!==j&&w(j,e)}else[v.DOWN,v.SPACE,v.ENTER].includes(t)&&(L(!0),e.preventDefault())}},b));return i.createElement("div",{className:c("".concat(o,"-nav-operations"),E),style:g,ref:n},q,i.createElement(D,{prefixCls:o,locale:d,editable:y}))}const L=i.memo(i.forwardRef(A),(function(e,t){return t.tabMoving}));function S(e){var a,n=e.prefixCls,o=e.id,r=e.active,l=e.tab,s=l.key,u=l.label,f=l.disabled,d=l.closeIcon,p=e.closable,b=e.renderWrapper,h=e.removeAriaLabel,g=e.editable,E=e.onClick,y=e.onFocus,k=e.style,C="".concat(n,"-tab"),x=g&&!1!==p&&!f;function w(e){f||E(e)}var N=i.createElement("div",{key:s,"data-node-key":m(s),className:c(C,(a={},t(a,"".concat(C,"-with-remove"),x),t(a,"".concat(C,"-active"),r),t(a,"".concat(C,"-disabled"),f),a)),style:k,onClick:w},i.createElement("div",{role:"tab","aria-selected":r,id:o&&"".concat(o,"-tab-").concat(s),className:"".concat(C,"-btn"),"aria-controls":o&&"".concat(o,"-panel-").concat(s),"aria-disabled":f,tabIndex:f?null:0,onClick:function(e){e.stopPropagation(),w(e)},onKeyDown:function(e){[v.SPACE,v.ENTER].includes(e.which)&&(e.preventDefault(),w(e))},onFocus:y},u),x&&i.createElement("button",{type:"button","aria-label":h||"remove",tabIndex:0,className:"".concat(C,"-remove"),onClick:function(e){var t;e.stopPropagation(),(t=e).preventDefault(),t.stopPropagation(),g.onEdit("remove",{key:s,event:t})}},d||g.removeIcon||"×"));return b?b(N):N}var P=function(e){var t=e.current||{},a=t.offsetWidth,n=void 0===a?0:a,o=t.offsetHeight;return[n,void 0===o?0:o]},j=function(e,t){return e[t?0:1]};function M(r,l){var s,u=i.useContext(f),v=u.prefixCls,N=u.tabs,R=r.className,T=r.style,A=r.id,M=r.animated,B=r.activeKey,K=r.rtl,W=r.extra,F=r.editable,V=r.locale,z=r.tabPosition,G=r.tabBarGutter,_=r.children,q=r.onTabClick,H=r.onTabScroll,O=i.useRef(),U=i.useRef(),J=i.useRef(),Q=i.useRef(),X=i.useRef(),Y=i.useRef(),Z=i.useRef(),$="top"===z||"bottom"===z,ee=E(0,(function(e,t){$&&H&&H({direction:e>t?"left":"right"})})),te=e(ee,2),ae=te[0],ne=te[1],oe=E(0,(function(e,t){!$&&H&&H({direction:e>t?"top":"bottom"})})),re=e(oe,2),ie=re[0],ce=re[1],le=i.useState([0,0]),se=e(le,2),ue=se[0],fe=se[1],de=i.useState([0,0]),ve=e(de,2),me=ve[0],pe=ve[1],be=i.useState([0,0]),he=e(be,2),ge=he[0],Ee=he[1],ye=i.useState([0,0]),ke=e(ye,2),Ce=ke[0],xe=ke[1],we=y(new Map),Ne=e(we,2),Re=Ne[0],Te=Ne[1],De=k(N,Re,me[0]),Ie=j(ue,$),Ae=j(me,$),Le=j(ge,$),Se=j(Ce,$),Pe=Ie<Ae+Le,je=Pe?Ie-Se:Ie-Le,Me="".concat(v,"-nav-operations-hidden"),Be=0,Ke=0;function We(e){return e<Be?Be:e>Ke?Ke:e}$&&K?(Be=0,Ke=Math.max(0,Ae-je)):(Be=Math.min(0,je-Ae),Ke=0);var Fe=i.useRef(),Ve=i.useState(),ze=e(Ve,2),Ge=ze[0],_e=ze[1];function qe(){_e(Date.now())}function He(){window.clearTimeout(Fe.current)}C(Q,(function(e,t){function a(e,t){e((function(e){return We(e+t)}))}return!!Pe&&($?a(ne,e):a(ce,t),He(),qe(),!0)})),i.useEffect((function(){return He(),Ge&&(Fe.current=window.setTimeout((function(){_e(0)}),100)),He}),[Ge]);var Oe=x(De,je,$?ae:ie,Ae,Le,Se,a(a({},r),{},{tabs:N})),Ue=e(Oe,2),Je=Ue[0],Qe=Ue[1],Xe=p((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B,t=De.get(e)||{width:0,height:0,left:0,right:0,top:0};if($){var a=ae;K?t.right<ae?a=t.right:t.right+t.width>ae+je&&(a=t.right+t.width-je):t.left<-ae?a=-t.left:t.left+t.width>-ae+je&&(a=-(t.left+t.width-je)),ce(0),ne(We(a))}else{var n=ie;t.top<-ie?n=-t.top:t.top+t.height>-ie+je&&(n=-(t.top+t.height-je)),ne(0),ce(We(n))}})),Ye={};"top"===z||"bottom"===z?Ye[K?"marginRight":"marginLeft"]=G:Ye.marginTop=G;var Ze=N.map((function(e,t){var a=e.key;return i.createElement(S,{id:A,prefixCls:v,key:a,tab:e,style:0===t?void 0:Ye,closable:e.closable,editable:F,active:a===B,renderWrapper:_,removeAriaLabel:null==V?void 0:V.removeAriaLabel,onClick:function(e){q(a,e)},onFocus:function(){Xe(a),qe(),Q.current&&(K||(Q.current.scrollLeft=0),Q.current.scrollTop=0)}})})),$e=function(){return Te((function(){var e=new Map;return N.forEach((function(t){var a,n=t.key,o=null===(a=X.current)||void 0===a?void 0:a.querySelector('[data-node-key="'.concat(m(n),'"]'));o&&e.set(n,{width:o.offsetWidth,height:o.offsetHeight,left:o.offsetLeft,top:o.offsetTop})})),e}))};i.useEffect((function(){$e()}),[N.map((function(e){return e.key})).join("_")]);var et=w((function(){var e=P(O),t=P(U),a=P(J);fe([e[0]-t[0]-a[0],e[1]-t[1]-a[1]]);var n=P(Z);Ee(n);var o=P(Y);xe(o);var r=P(X);pe([r[0]-n[0],r[1]-n[1]]),$e()})),tt=N.slice(0,Je),at=N.slice(Qe+1),nt=[].concat(n(tt),n(at)),ot=i.useState(),rt=e(ot,2),it=rt[0],ct=rt[1],lt=De.get(B),st=i.useRef();function ut(){b.cancel(st.current)}i.useEffect((function(){var e={};return lt&&($?(K?e.right=lt.right:e.left=lt.left,e.width=lt.width):(e.top=lt.top,e.height=lt.height)),ut(),st.current=b((function(){ct(e)})),ut}),[lt,$,K]),i.useEffect((function(){Xe()}),[B,Be,Ke,h(lt),h(De),$]),i.useEffect((function(){et()}),[K]);var ft,dt,vt,mt,pt=!!nt.length,bt="".concat(v,"-nav-wrap");return $?K?(dt=ae>0,ft=ae!==Ke):(ft=ae<0,dt=ae!==Be):(vt=ie<0,mt=ie!==Be),i.createElement(d,{onResize:et},i.createElement("div",{ref:g(l,O),role:"tablist",className:c("".concat(v,"-nav"),R),style:T,onKeyDown:function(){qe()}},i.createElement(I,{ref:U,position:"left",extra:W,prefixCls:v}),i.createElement("div",{className:c(bt,(s={},t(s,"".concat(bt,"-ping-left"),ft),t(s,"".concat(bt,"-ping-right"),dt),t(s,"".concat(bt,"-ping-top"),vt),t(s,"".concat(bt,"-ping-bottom"),mt),s)),ref:Q},i.createElement(d,{onResize:et},i.createElement("div",{ref:X,className:"".concat(v,"-nav-list"),style:{transform:"translate(".concat(ae,"px, ").concat(ie,"px)"),transition:Ge?"none":void 0}},Ze,i.createElement(D,{ref:Z,prefixCls:v,locale:V,editable:F,style:a(a({},0===Ze.length?void 0:Ye),{},{visibility:pt?"hidden":null})}),i.createElement("div",{className:c("".concat(v,"-ink-bar"),t({},"".concat(v,"-ink-bar-animated"),M.inkBar)),style:it})))),i.createElement(L,o({},r,{removeAriaLabel:null==V?void 0:V.removeAriaLabel,ref:Y,prefixCls:v,tabs:nt,className:!pt&&Me,tabMoving:!!Ge})),i.createElement(I,{ref:J,position:"right",extra:W,prefixCls:v})))}const B=i.forwardRef(M);var K=["renderTabBar"],W=["label","key"];function F(e){var t=e.renderTabBar,n=r(e,K),c=i.useContext(f).tabs;return t?t(a(a({},n),{},{panes:c.map((function(e){var t=e.label,a=e.key,n=r(e,W);return i.createElement(R,o({tab:t,key:a,tabKey:a},n))}))}),B):i.createElement(B,n)}export{F as T};
